!function(){function e(e,t){var i;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=n(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,c=!0,s=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return c=e.done,e},e:function(e){s=!0,r=e},f:function(){try{c||null==i.return||i.return()}finally{if(s)throw r}}}}function t(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||n(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"/on3":function(n,i,a){"use strict";(function(n){a.d(i,"a",(function(){return ee}));var c=a("n2fA"),s=a("FQBZ"),l=a("dT8p"),d=a("2Vo4"),u=a("0EQZ"),h=a("FvrZ"),p=a("8yBR"),b=a("STbY"),g=a("fXoL"),f=a("tyNb"),v=a("Witw"),m=a("aceb"),C=a("gvxT"),x=a("kmnG"),y=a("qFsG"),k=a("ofXK"),F=a("d3UM"),w=a("3Pt+"),S=a("bTqV"),I=a("FKr1"),O=a("IyRd"),N=a("znSr"),P=a("NFeN"),M=["emptyItem"],X=["qrPop"],j=["createPop"],Y=["newFavoriteFolder"];function q(e,t){if(1&e&&(g.Yb(0,"mat-option",24),g.Ic(1),g.Xb()),2&e){var n=t.$implicit;g.pc("value",n.id),g.Fb(1),g.Kc(" ",n.data.name," ")}}function T(e,t){if(1&e){var n=g.Zb();g.Yb(0,"nb-card"),g.Yb(1,"nb-card-header"),g.Ic(2,"Create Channel"),g.Xb(),g.Yb(3,"nb-card-body",16),g.Yb(4,"div",17),g.Ic(5," Folder: "),g.Yb(6,"mat-select",18),g.fc("valueChange",(function(e){return g.xc(n),g.jc().newChannelFolder=e}))("selectionChange",(function(e){return g.xc(n),g.jc().newChannelFolderChanged(e.value)})),g.Gc(7,q,2,2,"mat-option",19),g.Xb(),g.Xb(),g.Yb(8,"div",20),g.Yb(9,"input",21),g.fc("ngModelChange",(function(e){return g.xc(n),g.jc().newChannelName=e})),g.Xb(),g.Xb(),g.Xb(),g.Yb(10,"nb-card-footer"),g.Yb(11,"button",22),g.fc("click",(function(){g.xc(n);var e=g.jc();return e.createNewChannel(e.newChannelName)})),g.Ic(12,"Create"),g.Xb(),g.Yb(13,"button",23),g.fc("click",(function(){return g.xc(n),g.jc().closePopup()})),g.Ic(14,"Cancel"),g.Xb(),g.Xb(),g.Xb()}if(2&e){var i=g.jc();g.Fb(6),g.pc("value",i.newChannelFolder),g.Fb(1),g.pc("ngForOf",i.channelFolderListArray),g.Fb(2),g.pc("ngModel",i.newChannelName)}}function E(e,t){if(1&e){var n=g.Zb();g.Yb(0,"nb-card"),g.Yb(1,"nb-card-header"),g.Ic(2,"Scan QR"),g.Xb(),g.Yb(3,"nb-card-body",16),g.Yb(4,"div",25),g.Yb(5,"zxing-scanner",26),g.fc("deviceChange",(function(e){return g.xc(n),g.jc().currentDevice=e}))("scanSuccess",(function(e){return g.xc(n),g.jc().qrSuccessHandler(e)}))("permissionResponse",(function(e){return g.xc(n),g.jc().onHasPermission(e)}))("camerasFound",(function(e){return g.xc(n),g.jc().onCamerasFound(e)}))("torchCompatible",(function(e){return g.xc(n),g.jc().onTorchCompatible(e)})),g.Xb(),g.Xb(),g.Xb(),g.Yb(6,"nb-card-footer"),g.Yb(7,"button",23),g.fc("click",(function(){return g.xc(n),g.jc().closeQR()})),g.Ic(8,"Cancel"),g.Xb(),g.Xb(),g.Xb()}if(2&e){var i=g.jc();g.Fb(5),g.pc("torch",i.torchEnabled)("device",i.currentDevice)("formats",i.formatsEnabled)("tryHarder",i.tryHarder)}}function R(e,t){if(1&e&&(g.Yb(0,"mat-option",24),g.Ic(1),g.Xb()),2&e){var n=t.$implicit;g.pc("value",n.id),g.Fb(1),g.Kc(" ",n.data.name," ")}}function D(e,t){if(1&e){var n=g.Zb();g.Yb(0,"nb-card"),g.Yb(1,"nb-card-header"),g.Ic(2,"Join Channel"),g.Xb(),g.Yb(3,"nb-card-body",16),g.Yb(4,"div",17),g.Ic(5," Import Folder Structure: "),g.Yb(6,"mat-form-field",27),g.Yb(7,"mat-select",28),g.fc("valueChange",(function(e){return g.xc(n),g.jc().importFolderStructure=e}))("selectionChange",(function(e){return g.xc(n),g.jc().newInviteImportFoldersChanged(e.value)})),g.Yb(8,"mat-option",24),g.Ic(9," On "),g.Xb(),g.Yb(10,"mat-option",24),g.Ic(11," Off "),g.Xb(),g.Xb(),g.Xb(),g.Xb(),g.Yb(12,"div",17),g.Ic(13," Place Into Folder: "),g.Yb(14,"mat-select",18),g.fc("valueChange",(function(e){return g.xc(n),g.jc().newChannelFolder=e}))("selectionChange",(function(e){return g.xc(n),g.jc().newChannelFolderChanged(e.value)})),g.Gc(15,R,2,2,"mat-option",19),g.Xb(),g.Xb(),g.Yb(16,"div",20),g.Yb(17,"input",29),g.fc("ngModelChange",(function(e){return g.xc(n),g.jc().inviteCodeHex=e})),g.Xb(),g.Yb(18,"nb-icon",30),g.fc("click",(function(){return g.xc(n),g.jc().scanQR()})),g.Xb(),g.Xb(),g.Xb(),g.Yb(19,"nb-card-footer"),g.Yb(20,"button",22),g.fc("click",(function(){g.xc(n);var e=g.jc();return e.importNewChannel(e.inviteCode)})),g.Ic(21,"Join"),g.Xb(),g.Yb(22,"button",23),g.fc("click",(function(){return g.xc(n),g.jc().closePopup()})),g.Ic(23,"Cancel"),g.Xb(),g.Xb(),g.Xb()}if(2&e){var i=g.jc();g.Fb(7),g.pc("value",i.importFolderStructure),g.Fb(1),g.pc("value",1),g.Fb(2),g.pc("value",0),g.Fb(4),g.pc("value",i.newChannelFolder),g.Fb(1),g.pc("ngForOf",i.channelFolderListArray),g.Fb(2),g.pc("ngModel",i.inviteCodeHex)}}function B(e,t){if(1&e&&(g.Yb(0,"mat-option",24),g.Ic(1),g.Xb()),2&e){var n=t.$implicit;g.pc("value",n.id),g.Fb(1),g.Kc(" ",n.data.name," ")}}function L(e,t){if(1&e){var n=g.Zb();g.Yb(0,"nb-card"),g.Yb(1,"nb-card-header"),g.Ic(2,"New Favorite Folder"),g.Xb(),g.Yb(3,"nb-card-body",16),g.Yb(4,"div",17),g.Ic(5," Folder: "),g.Yb(6,"mat-select",18),g.fc("valueChange",(function(e){return g.xc(n),g.jc().newFavoriteFolderId=e}))("selectionChange",(function(e){return g.xc(n),g.jc().newFavoriteFolderChanged(e.value)})),g.Gc(7,B,2,2,"mat-option",19),g.Xb(),g.Xb(),g.Yb(8,"div",20),g.Yb(9,"input",31),g.fc("ngModelChange",(function(e){return g.xc(n),g.jc().newFavoriteFolderName=e})),g.Xb(),g.Xb(),g.Xb(),g.Yb(10,"nb-card-footer"),g.Yb(11,"button",22),g.fc("click",(function(){g.xc(n);var e=g.jc();return e.createNewFavoriteFolder(e.newFavoriteFolderName)})),g.Ic(12,"Create"),g.Xb(),g.Yb(13,"button",23),g.fc("click",(function(){return g.xc(n),g.jc().closePopup()})),g.Ic(14,"Cancel"),g.Xb(),g.Xb(),g.Xb()}if(2&e){var i=g.jc();g.Fb(6),g.pc("value",i.newFavoriteFolderId),g.Fb(1),g.pc("ngForOf",i.favoriteFolderListArray),g.Fb(2),g.pc("ngModel",i.newFavoriteFolderName)}}function _(e,t){if(1&e){var n=g.Zb();g.Yb(0,"div",36),g.fc("click",(function(){g.xc(n);var e=g.jc().$implicit;return g.jc().goToProfile(e.pubKey)})),g.Ic(1),g.Xb()}if(2&e){var i=g.jc().$implicit,a=g.jc();g.Fb(1),g.Kc(" ",a.getAliasFromDirectChannel(i.channel),"")}}function A(e,t){if(1&e){var n=g.Zb();g.Yb(0,"div",36),g.fc("click",(function(){g.xc(n);var e=g.jc().$implicit;return g.jc().goToProfile(e.pubKey)})),g.Ic(1," Unknown"),g.Xb()}}function K(e,t){if(1&e){var n=g.Zb();g.Yb(0,"div",32),g.Gc(1,_,2,1,"div",33),g.Gc(2,A,2,0,"div",33),g.Yb(3,"nb-icon",34),g.fc("click",(function(){g.xc(n);var e=t.$implicit;return g.jc().rejectRequest(e.pubKey)})),g.Xb(),g.Yb(4,"nb-icon",35),g.fc("click",(function(){g.xc(n);var e=t.$implicit;return g.jc().importNewChannel(e.invite)})),g.Xb(),g.Xb()}if(2&e){var i=t.$implicit,a=g.jc();g.Fb(1),g.pc("ngIf",a.getAliasFromDirectChannel(i.channel).indexOf("qprivatedch")<0),g.Fb(1),g.pc("ngIf",a.getAliasFromDirectChannel(i.channel).indexOf("qprivatedch")>-1)}}var G=function(e){return{"drag-start":e}};function z(e,t){if(1&e){var n=g.Zb();g.Yb(0,"div"),g.Tb(1,"nb-icon",39),g.Yb(2,"span",40),g.fc("dragstart",(function(e){g.xc(n);var t=g.jc().$implicit;return g.jc().handleDragStart(e,t)})),g.Yb(3,"span",41),g.Ic(4),g.Xb(),g.Xb(),g.Xb()}if(2&e){var i=g.jc().$implicit,a=g.jc();g.Ib("treeNodeContainerSingle ",i.item,""),g.Kb("active-channel",a.selectedChannel===i.item),g.Fb(3),g.pc("ngClass",g.sc(7,G,a.dragNode===i)),g.Fb(1),g.Kc(" ",a.getAliasFromDirectChannel2(i.item)," ")}}function H(e,t){if(1&e){var n=g.Zb();g.Yb(0,"div"),g.Tb(1,"nb-icon",42),g.Yb(2,"span",40),g.fc("dragstart",(function(e){g.xc(n);var t=g.jc().$implicit;return g.jc().handleDragStart(e,t)})),g.Yb(3,"span",43),g.Ic(4," Unknown "),g.Xb(),g.Xb(),g.Xb()}if(2&e){var i=g.jc().$implicit,a=g.jc();g.Ib("treeNodeContainerSingle ",i.item,""),g.Kb("active-channel",a.selectedChannel===i.item),g.Fb(3),g.pc("ngClass",g.sc(6,G,a.dragNode===i))}}function $(e,t){if(1&e){var n=g.Zb();g.Yb(0,"mat-tree-node",37),g.fc("dragover",(function(e){g.xc(n);var i=t.$implicit;return g.jc().handleDragOver(e,i)}))("dragend",(function(e){return g.xc(n),g.jc().handleDragEnd(e)}))("drop",(function(e){g.xc(n);var i=t.$implicit;return g.jc().handleDrop(e,i)}))("click",(function(){g.xc(n);var e=t.$implicit;return g.jc().selectChannel(e.item)})),g.Gc(1,z,5,9,"div",38),g.Gc(2,H,5,8,"div",38),g.Xb()}if(2&e){var i=t.$implicit,a=g.jc();g.pc("ngClass",a.getStyle(i)),g.Fb(1),g.pc("ngIf",a.getAliasFromDirectChannel2(i.item).indexOf("qprivatedch")<0),g.Fb(1),g.pc("ngIf",a.getAliasFromDirectChannel2(i.item).indexOf("qprivatedch")>-1)}}function V(e,t){if(1&e){var n=g.Zb();g.Yb(0,"mat-tree-node",44),g.fc("dragover",(function(e){g.xc(n);var i=t.$implicit;return g.jc().handleDragOver(e,i)}))("dragend",(function(e){g.xc(n);var i=t.$implicit;return g.jc().handleDragEnd(e,i)}))("drop",(function(e){g.xc(n);var i=t.$implicit;return g.jc().handleDrop(e,i)})),g.Yb(1,"div",45),g.fc("contextmenu",(function(e){g.xc(n);var i=t.$implicit;return g.jc().onContextMenu(e,i.item)})),g.Yb(2,"button",46),g.Yb(3,"mat-icon",47),g.Ic(4),g.Xb(),g.Xb(),g.Tb(5,"nb-icon",48),g.Yb(6,"span",40),g.fc("dragstart",(function(e){g.xc(n);var i=t.$implicit;return g.jc().handleDragStart(e,i)})),g.Yb(7,"span",49),g.Ic(8),g.Xb(),g.Xb(),g.Xb(),g.Xb()}if(2&e){var i=t.$implicit,a=g.jc();g.pc("ngClass",a.getStyle(i)),g.Fb(2),g.Gb("aria-label","toggle "+i.item),g.Fb(2),g.Kc(" ",a.treeControl.isExpanded(i)?"expand_more":"chevron_right"," "),g.Fb(3),g.pc("ngClass",g.sc(5,G,a.dragNode===i)),g.Fb(1),g.Kc(" ",a.getFavoriteFolderNameFromId(i.item)," ")}}function Z(e,t){if(1&e){var n=g.Zb();g.Yb(0,"button",50),g.fc("click",(function(){g.xc(n);var e=t.item;return g.jc().deleteFolder(e)})),g.Ic(1,"Delete"),g.Xb(),g.Yb(2,"button",50),g.fc("click",(function(){g.xc(n);var e=t.item;return g.jc().onContextMenuAction2(e)})),g.Ic(3,"Rename"),g.Xb(),g.Yb(4,"button",50),g.fc("click",(function(){g.xc(n);var e=t.item;return g.jc().onContextMenuAction2(e)})),g.Ic(5,"New Channel"),g.Xb()}}var W=function e(){r(this,e)},Q=function e(){r(this,e)},J={},U=function(){var e=function(){function e(){r(this,e),this.dataChange=new d.a([]),this.initialize()}return o(e,[{key:"initialize",value:function(){this.buildFileTree(J,0)}},{key:"buildFileTree",value:function(e,t){var n=this;return Object.keys(e).reduce((function(i,a){var o=e[a],r=new W;return r.item=a,null!=o&&("object"==typeof o?r.children=n.buildFileTree(o,t+1):r.item=o),i.concat(r)}),[])}},{key:"insertItem",value:function(e,t){e.children||(e.children=[]);var n={item:t};return e.children.push(n),this.dataChange.next(this.data),n}},{key:"getParentFromNodes",value:function(e){for(var t=0;t<this.data.length;++t){var n=this.getParent(this.data[t],e);if(null!=n)return n}return null}},{key:"getParent",value:function(e,t){if(e.children&&e.children.length>0)for(var n=0;n<e.children.length;++n){var i=e.children[n];if(i===t)return e;if(i.children&&i.children.length>0){var a=this.getParent(i,t);if(null!=a)return a}}return null}},{key:"updateItem",value:function(e,t){e.item=t,this.dataChange.next(this.data)}},{key:"deleteItem",value:function(e){this.deleteNode(this.data,e),this.dataChange.next(this.data)}},{key:"copyPasteItem",value:function(e,t){var n=this,i=this.insertItem(t,e.item);return e.children&&e.children.forEach((function(e){n.copyPasteItem(e,i)})),i}},{key:"deleteNode",value:function(e,t){var n=this,i=e.indexOf(t,0);i>-1?e.splice(i,1):e.forEach((function(e){e.children&&e.children.length>0&&n.deleteNode(e.children,t)}))}},{key:"filter",value:function(e){var t;t=e&&e.length>0?{Filter:{emptyFolder:{}},Function:{emptyFolder:{}},Missing:{emptyFolder:{}}}:J;var n=this.buildFileTree(t,0);this.dataChange.next(n)}},{key:"setQOS",value:function(e){this.q=e}},{key:"data",get:function(){return this.dataChange.value}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=g.Ob({token:e,factory:e.\u0275fac}),e}(),ee=function(){var i=function(){function i(e,t,n,a,o,c,b,g){var f=this;r(this,i),this.router=e,this.ngZone=t,this.cd=n,this.database=a,this.ui=o,this.dialog=c,this.nbMenuService=b,this.q=g,this.contextMenuPosition={x:"0px",y:"0px"},this.flatNodeMap=new Map,this.nestedNodeMap=new Map,this.selectedParent=null,this.newItemName="",this.checklistSelection=new u.c(!0),this.dragNodeExpandOverWaitTimeMs=300,this.getLevel=function(e){return e.level},this.isExpandable=function(e){return e.expandable},this.getChildren=function(e){return e.children},this.hasChild=function(e,t){return t.expandable},this.hasNoContent=function(e,t){return""===t.item},this.transformer=function(e,t){var n=f.nestedNodeMap.get(e),i=n&&n.item===e.item?n:new Q;return i.item=e.item,i.level=t,i.expandable=e.children&&e.children.length>0,f.flatNodeMap.set(i,e),f.nestedNodeMap.set(e,i),i},this.dragNodeExpandOverAreaReal=0,this.channelNameList=[],this.incomingFavoriteRequestList=[],this.restoreFlag=0,this.sENwriteBlock=0,this.channelIsSelected="active-channel",this.DEVMODE=l.dev,this.customColumn="name",this.items=[{title:"New Favorite Folder"},{title:"Add Favorite"}],this.currentDevice=null,this.formatsEnabled=[s.BarcodeFormat.QR_CODE],this.torchEnabled=!1,this.torchAvailable$=new d.a(!1),this.tryHarder=!1,this.favoriteFolderListArray=[],this.popupRef=[],this.flatChannelNameList={},this.flatChannelNameList2={},this.flatChannelNeeded=[],this.flatChannelNeeded2=[],this.itemClickSub=this.nbMenuService.onItemClick().subscribe((function(e){"New Favorite Folder"==String(e.item.title)&&(f.getFavoriteFolderList(),f.open(f.newFavoriteFolderPop))})),this.database.setQOS(this.q),this.treeFlattener=new p.c(this.transformer,this.getLevel,this.isExpandable,this.getChildren),this.treeControl=new h.j(this.getLevel,this.isExpandable),this.dataSource=new p.b(this.treeControl,this.treeFlattener)}return o(i,[{key:"onContextMenu",value:function(e,t){e.preventDefault(),this.contextMenuPosition.x=e.clientX+"px",this.contextMenuPosition.y=e.clientY-40+"px",this.contextMenu.menuData={item:t},this.contextMenu.openMenu()}},{key:"onContextMenuAction1",value:function(e){}},{key:"onContextMenuAction2",value:function(e){}},{key:"descendantsAllSelected",value:function(e){var t=this;return this.treeControl.getDescendants(e).every((function(e){return t.checklistSelection.isSelected(e)}))}},{key:"descendantsPartiallySelected",value:function(e){var t=this;return this.treeControl.getDescendants(e).some((function(e){return t.checklistSelection.isSelected(e)}))&&!this.descendantsAllSelected(e)}},{key:"todoItemSelectionToggle",value:function(e){var n,i;this.checklistSelection.toggle(e);var a=this.treeControl.getDescendants(e);this.checklistSelection.isSelected(e)?(n=this.checklistSelection).select.apply(n,t(a)):(i=this.checklistSelection).deselect.apply(i,t(a))}},{key:"saveNode",value:function(e,t){var n=this.flatNodeMap.get(e);this.database.updateItem(n,t)}},{key:"handleDragStart",value:function(e,t){this.dragNode=t,this.treeControl.collapse(t)}},{key:"handleDragOver",value:function(e,t){if(e.preventDefault(),-1===t.item.indexOf("-----")){this.dragNodeExpandOverNode&&t===this.dragNodeExpandOverNode?Date.now()-this.dragNodeExpandOverTime>this.dragNodeExpandOverWaitTimeMs&&(this.treeControl.isExpanded(t)||this.treeControl.expand(t)):(this.dragNodeExpandOverNode=t,this.dragNodeExpandOverTime=(new Date).getTime());var n=e.offsetY/e.target.clientHeight;0<=n&&n<=.25?(this.dragNodeExpandOverArea=0,this.dragNodeExpandOverAreaReal=1):1>=n&&n>=.75?(this.dragNodeExpandOverArea=0,this.dragNodeExpandOverAreaReal=-1):(this.dragNodeExpandOverAreaReal=0,this.dragNodeExpandOverArea=0)}}},{key:"handleDrop",value:function(e,t){var n;t!==this.dragNode&&t.item.indexOf("-----")<0&&(1===this.dragNodeExpandOverAreaReal||-1===this.dragNodeExpandOverAreaReal||(n=this.flatNodeMap.get(this.dragNode),this.database.deleteItem(n),n=this.database.copyPasteItem(n,this.flatNodeMap.get(t)),this.saveExpandedNodes(),this.buildFavoriteFolderListFromTreeNodeData()));this.handleDragEnd(e)}},{key:"handleDragEnd",value:function(e){this.dragNode=null,this.dragNodeExpandOverNode=null,this.dragNodeExpandOverTime=0,this.dragNodeExpandOverArea=NaN,e.preventDefault()}},{key:"getStyle",value:function(e){if("emptyFolder"==e.item)return"display-none";if(this.dragNode===e)return"drag-start";if(this.dragNodeExpandOverNode===e)switch(this.dragNodeExpandOverArea){case 1:return"drop-above";case-1:return"drop-below";default:return"drop-center"}}},{key:"closeQR",value:function(){var e=this;setTimeout((function(){e.closePopup()}),500)}},{key:"scanQR",value:function(){this.open(this.qrPop)}},{key:"deleteItem",value:function(e){this.database.deleteItem(this.flatNodeMap.get(e))}},{key:"filterChanged",value:function(e){this.database.filter(e),e?this.treeControl.expandAll():this.treeControl.collapseAll()}},{key:"getFavoriteFolderNameFromId",value:function(e){return"emptyFolder"==e?e:this.q.os.bee.config.getFavoriteFolderNameFromId(e)}},{key:"isFolder",value:function(e){return!(e.indexOf("-----")>-1)}},{key:"buildFavoritelFolderListFromTreeNodeData",value:function(){console.log("!!!!!"),console.log(this.database.data);var e=this.database.data;e=e.filter((function(e){return"emptyFolder"!=e.item}));for(var t=[],n=0;n<e.length;n++){console.log(e[n]);var i="dir";e[n].item.indexOf("-----")>-1&&(i="channel"),console.log(i);var a=[];void 0!==e[n].children&&e[n].children.length>0&&(a=this.getFavoriteFolderListTreeChildrenRec(e[n].children)),t.push({id:e[n].item,data:{name:this.q.os.bee.config.getFavoriteFolderNameFromId(e[n].item),kind:i,items:0},children:a})}return this.q.os.bee.config.setFavoriteFolderList(t),!0}},{key:"ngOnDestroy",value:function(){console.log("ChannelList: ngOnDestroy..."),clearInterval(this.updateNamesInterval),this.itemClickSub.unsubscribe(),this.dataChangeSub.unsubscribe(),this.favoriteFolderListSub.unsubscribe(),this.selectedChannelSub.unsubscribe()}},{key:"ngOnInit",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.q.os.isSignedIn()){e.next=6;break}return console.log("ChannelList: Waiting for OS Sign In..."),e.next=4,this.ui.delay(1e3);case 4:e.next=0;break;case 6:this.updateNamesInterval=setInterval((function(){t.saveExpandedNodes(),t.loadChannels(t.favoriteFolderList),setTimeout((function(){t.saveExpandedNodes(),t.loadChannels(t.favoriteFolderList)}),2e3)}),2e4),this.channelNameList=this.q.os.ocean.dolphin.getChannelNameList(),this.favoriteFolderList=this.q.os.bee.config.getFavoriteFolderList(),this.dataChangeSub=this.database.dataChange.subscribe((function(e){t.dataSource.data=[],t.dataSource.data=e})),this.favoriteFolderListSub=this.q.os.bee.config.favoriteFolderListSub.subscribe((function(e){t.loadChannels(e)})),this.selectedChannelSub=this.q.os.channel.onSelect().subscribe((function(e){t.selectedChannel=e})),this.loadChannels(this.favoriteFolderList),setTimeout((function(){t.saveExpandedNodes(),t.loadChannels(t.favoriteFolderList)}),2e3),this.selectedChannel=this.q.os.channel.getSelected(),this.cd.detectChanges();case 7:case"end":return e.stop()}}),e,this)})))}},{key:"loadChannels",value:function(e){var t=this;this.incomingFavoriteRequestList=this.q.os.ocean.dolphin.getIncomingFavoriteRequests().filter((function(e){return!t.q.os.utilities.inArray(t.q.os.ocean.dolphin.getChannelNameList(),e.channel)})),J=this.q.os.bee.config.getFavoriteFolderIDList(),this.database.filter(""),e.length>0&&this.q.os.bee.config.getExpandedFavoriteFolderItems().length>0&&(console.log("got a saved state!"),this.expandedNodes=this.q.os.bee.config.getExpandedFavoriteFolderItems(),this.restoreExpandedNodes()),this.updateNames()}},{key:"saveExpandedNodes",value:function(){this.sENwriteBlock=1,this.expandedNodes=[];for(var e=0;e<this.treeControl.dataNodes.length;e++){var t=this.treeControl.dataNodes[e];t.expandable&&this.treeControl.isExpanded(t)&&this.expandedNodes.push(t)}return console.log("ChannelList: Persisting expanded folders..."),this.q.os.bee.config.setExpandedFavoriteFolderItems(this.expandedNodes),this.sENwriteBlock=0,!0}},{key:"buildFavoriteFolderListFromTreeNodeData",value:function(){console.log("!!!!!"),console.log(this.database.data);var e=this.database.data;e=e.filter((function(e){return"emptyFolder"!=e.item}));for(var t=[],n=0;n<e.length;n++){console.log(e[n]);var i="dir";e[n].item.indexOf("-----")>-1&&(i="channel"),console.log(i);var a=[];void 0!==e[n].children&&e[n].children.length>0&&(a=this.getFavoriteFolderListTreeChildrenRec(e[n].children)),t.push({id:e[n].item,data:{name:this.q.os.bee.config.getFavoriteFolderNameFromId(e[n].item),kind:i,items:0},children:a})}return this.q.os.bee.config.setFavoriteFolderList(t),!0}},{key:"selectChannel",value:function(e){console.log("ChannelList: Trying to select: >>"+e.trim()),this.q.os.utilities.inArray(this.q.os.ocean.dolphin.getChannelNameList(),e.trim())&&(console.log("ChannelList: Selecting: ",e.trim()),this.q.os.channel.select(e.trim()),this.q.os.ui.getSideBarFixed().left&&this.q.os.ui.hideSideBar("left"),this.cd.detectChanges())}},{key:"getSelected",value:function(){return JSON.stringify(this.selectedChannel)}},{key:"getFavoriteFolderListTreeChildrenRec",value:function(e){for(var t=[],n=0;n<e.length;n++){console.log(e[n]);var i="dir";e[n].item.indexOf("-----")>-1&&(i="channel");var a=[];void 0!==e[n].children&&e[n].children.length>0&&(a=this.getFavoriteFolderListTreeChildrenRec(e[n].children)),t.push({id:e[n].item,data:{name:this.q.os.bee.config.getFavoriteFolderNameFromId(e[n].item),kind:i,items:0},children:a})}return t}},{key:"restoreExpandedNodes",value:function(){var e=this;this.sENwriteBlock=1;for(var t=function(t){var n=e.expandedNodes[t];console.log(n),console.log(e.treeControl.dataNodes),e.treeControl.expand(e.treeControl.dataNodes.find((function(e){return e.item===n.item})))},n=0;n<this.expandedNodes.length;n++)t(n);this.sENwriteBlock=0}},{key:"onCamerasFound",value:function(e){this.availableDevices=e,this.hasDevices=Boolean(e&&e.length)}},{key:"onDeviceSelectChange",value:function(e){var t=this.availableDevices.find((function(t){return t.deviceId===e}));this.currentDevice=t||null}},{key:"onHasPermission",value:function(e){this.hasPermission=e}},{key:"onTorchCompatible",value:function(e){this.torchAvailable$.next(e||!1)}},{key:"toggleTorch",value:function(){this.torchEnabled=!this.torchEnabled}},{key:"toggleTryHarder",value:function(){this.tryHarder=!this.tryHarder}},{key:"qrSuccessHandler",value:function(e){console.log(e),this.inviteCodeHex=e,this.closePopup()}},{key:"getFavoriteFolderList",value:function(){return this.favoriteFolderList=this.q.os.bee.config.getFavoriteFolderList(),this.favoriteFolderListArray=[],this.parseStructure(this.favoriteFolderList),this.favoriteFolderListArray.length>0&&(this.newFavoriteFolder=this.favoriteFolderListArray[0]),this.favoriteFolderList}},{key:"parseStructure",value:function(e){for(var t=0;t<e.length;t++)-1===e[t].data.name.indexOf("-----")&&"emptyFolder"!=e[t].data.name&&(this.favoriteFolderListArray.push(e[t]),void 0!==e[t].children&&this.parseStructure(e[t].children));return e}},{key:"newChannelFolderChanged",value:function(){}},{key:"createNewChannel",value:function(e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"open",value:function(e){this.popupRef.push(this.dialog.open(e,{context:"this is some additional data passed to dialog"}))}},{key:"closePopup",value:function(){console.log("close toggled"),this.popupRef[this.popupRef.length-1].close(),this.popupRef.pop()}},{key:"createCompleteAndClose",value:function(){this.ui.delay(1e3),this.q.os.bee.config.commit(),this.ui.showSnack("Success!","Yesss",{duration:1e3}),this.closePopup()}},{key:"createNewFavoriteFolder",value:function(e){this.saveExpandedNodes(),this.ui.showSnack("Creating Folder...","Please Wait");var t=this.newFavoriteFolderId;"object"==typeof t&&(t=""),this.q.os.bee.config.createFavoriteFolder(e,t),this.createCompleteAndClose()}},{key:"deleteFolder",value:function(e){console.log("Deleting Folder..."),console.log(e);var t=this.q.os.bee.config.checkIfFavoriteFolderIdChannels(e);console.log(t),t?this.ui.showSnack("Folder has channels!","Sorry but no.",{duration:5e3}):(this.ui.showSnack("Deleting Folder...","Please Wait"),this.saveExpandedNodes(),this.q.os.bee.config.deleteFavoriteFolder(e),this.createCompleteAndClose())}},{key:"importChannelFolderChanged",value:function(){}},{key:"importNewChannel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"NoInviteSelected";return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,a,o,r,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.saveExpandedNodes(),this.ui.showSnack("Importing Channel...","Please Wait"),"NoInviteSelected"==e&&(e=this.inviteCodeHex),o=n.from(e,"hex").toString("utf8"),(r=o.split("/////")).length>0?(i=r[r.length-1].split(":")[0],a=r[r.length-1].split(":")[1],r.pop()):(i=o.split(":")[0],a=o.split(":")[1]),"object"!=typeof(c=this.newFavoriteFolder)&&void 0!==c&&null!=typeof c||(c=""),!this.q.os.utilities.inArray(this.q.os.ocean.dolphin.getChannelNameList(),i)){t.next=9;break}this.ui.showSnack("Channel Exists!","Oops",{duration:1e3}),t.next=15;break;case 9:return this.q.os.ocean.dolphin.removeIncomingFavoriteRequest(i.split("-----")[0].split("-")[1]),this.q.os.social.profile.addFavorite(i.split("-----")[0].split("-")[1]),console.log("ChannelFavorites: Adding Favorite: ",i.split("-----")[0].split("-")[1]),t.next=14,this.q.os.channel.import(i,r,"",a,0);case 14:this.createCompleteAndClose();case 15:case"end":return t.stop()}}),t,this)})))}},{key:"rejectRequest",value:function(e){this.q.os.ocean.dolphin.removeIncomingFavoriteRequest(e),this.saveExpandedNodes(),this.loadChannels(this.favoriteFolderList),this.q.os.commitNow()}},{key:"newInviteImportFoldersChanged",value:function(){}},{key:"goToProfile",value:function(e){var t=this;this.ngZone.run((function(){return t.router.navigate(["/social/profile/"+e])}))}},{key:"updateNames",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i,a,o,r,c,s,l,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=[],i=e(this.flatChannelNeeded),t.prev=2,i.s();case 4:if((a=i.n()).done){t.next=13;break}if(o=a.value,!(n.indexOf(o)<0)){t.next=11;break}return t.next=9,this.q.os.social.getAliasFromDirectChannel(o);case 9:r=t.sent,console.log(r),n.push(o),this.flatChannelNameList[o]=r;case 11:t.next=4;break;case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(2),i.e(t.t0);case 18:return t.prev=18,i.f(),t.finish(18);case 21:c=e(this.flatChannelNeeded2),t.prev=22,c.s();case 24:if((s=c.n()).done){t.next=33;break}if(l=s.value,!(n.indexOf(l)<0)){t.next=31;break}return t.next=29,this.q.os.social.getAliasFromDirectChannel2(l);case 29:d=t.sent,console.log(d),n.push(l),this.flatChannelNameList2[l]=d;case 31:t.next=24;break;case 33:t.next=38;break;case 35:t.prev=35,t.t1=t.catch(22),c.e(t.t1);case 38:return t.prev=38,c.f(),t.finish(38);case 41:this.cd.detectChanges();case 42:case"end":return t.stop()}}),t,this,[[2,15,18,21],[22,35,38,41]])})))}},{key:"getAliasFromDirectChannel",value:function(e){return this.flatChannelNeeded.push(e),void 0!==this.flatChannelNameList[e]?this.flatChannelNameList[e]:e}},{key:"getAliasFromDirectChannel2",value:function(e){return this.flatChannelNeeded2.push(e),void 0!==this.flatChannelNameList2[e]?this.flatChannelNameList2[e]:e}}]),i}();return i.\u0275fac=function(e){return new(e||i)(g.Sb(f.c),g.Sb(g.C),g.Sb(g.h),g.Sb(U),g.Sb(v.a),g.Sb(m.l),g.Sb(m.y),g.Sb(C.a))},i.\u0275cmp=g.Mb({type:i,selectors:[["messages-channel-favorites"]],viewQuery:function(e,t){var n;1&e&&(g.Mc(b.d,!0),g.Mc(M,!0),g.Mc(X,!0),g.Mc(j,!0),g.Mc(Y,!0)),2&e&&(g.uc(n=g.gc())&&(t.contextMenu=n.first),g.uc(n=g.gc())&&(t.emptyItem=n.first),g.uc(n=g.gc())&&(t.qrPop=n.first),g.uc(n=g.gc())&&(t.createPop=n.first),g.uc(n=g.gc())&&(t.newFavoriteFolderPop=n.first))},features:[g.Eb([U])],decls:22,vars:10,consts:[["createPop",""],["qrPop",""],["import",""],["newFavoriteFolder",""],[2,"width","169px","margin-top","20px","color","#598adb"],["matInput","","placeholder","Search",3,"input"],["outline","","size","small",1,"addChannelButton",3,"nbContextMenu"],["icon","plus-outline",2,"font-size","18px","width","auto"],["class","favoriteRequest",4,"ngFor","ngForOf"],[3,"dataSource","treeControl"],["matTreeNodeToggle","","matTreeNodePadding","",3,"ngClass","dragover","dragend","drop","click",4,"matTreeNodeDef"],["matTreeNodePadding","",3,"ngClass","dragover","dragend","drop",4,"matTreeNodeDef","matTreeNodeDefWhen"],[2,"visibility","hidden","position","fixed",3,"matMenuTriggerFor"],["contextMenu","matMenu"],["matMenuContent",""],["emptyItem",""],[2,"color","goldenrod"],[2,"padding","20px"],[2,"width","80%","margin-left","10px",3,"value","valueChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[2,"padding","20px","padding-bottom","34px","padding-top","0px","color","white !important"],["matInput","","placeholder","Channel Name","value","","name","newChannelName",2,"color","black","background-color","goldenrod","padding","7px",3,"ngModel","ngModelChange"],["mat-stroked-button","","color","primary",2,"margin-right","20px","border","1px solid #ffffff24",3,"click"],["mat-stroked-button","","color","primary",2,"border","1px solid #ffffff24",3,"click"],[3,"value"],[1,"qrScanWrapper"],[3,"torch","device","formats","tryHarder","deviceChange","scanSuccess","permissionResponse","camerasFound","torchCompatible"],[2,"width","19%"],[3,"value","valueChange","selectionChange"],["matInput","","placeholder","Invite Code","value","","name","inviteCodeHex",2,"color","black","background-color","goldenrod","padding","7px","margin-right","5%","width","80%",3,"ngModel","ngModelChange"],["icon","camera-outline",1,"deleteCode","scanQRCode",3,"click"],["matInput","","placeholder","Folder Name","value","","name","newFavoriteFolderName",2,"color","black","background-color","goldenrod","padding","7px",3,"ngModel","ngModelChange"],[1,"favoriteRequest"],["class","favoriteRequestText",3,"click",4,"ngIf"],["icon","close-square-outline",2,"color","#ff0000bd","float","right","cursor","pointer",3,"click"],["icon","checkmark-square-2-outline",2,"color","#16eb16","float","right","cursor","pointer",3,"click"],[1,"favoriteRequestText",3,"click"],["matTreeNodeToggle","","matTreeNodePadding","",3,"ngClass","dragover","dragend","drop","click"],[3,"class","active-channel",4,"ngIf"],["icon","activity"],["draggable","true",1,"checklist-leaf-node",3,"dragstart"],[1,"nodeContent",2,"width","100%",3,"ngClass"],["icon","question-mark-outline"],[1,"nodeContent","unknown",2,"width","100%",3,"ngClass"],["matTreeNodePadding","",3,"ngClass","dragover","dragend","drop"],[1,"treeNodeContainerFolder",3,"contextmenu"],["mat-icon-button","","matTreeNodeToggle",""],[1,"mat-icon-rtl-mirror"],["icon","folder-outline"],[1,"nodeContent",3,"ngClass"],["mat-menu-item","",3,"click"]],template:function(e,t){if(1&e&&(g.Gc(0,T,15,3,"ng-template",null,0,g.Hc),g.Gc(2,E,9,4,"ng-template",null,1,g.Hc),g.Gc(4,D,24,6,"ng-template",null,2,g.Hc),g.Gc(6,L,15,3,"ng-template",null,3,g.Hc),g.Yb(8,"mat-form-field",4),g.Yb(9,"input",5),g.fc("input",(function(e){return t.filterChanged(e.target.value)})),g.Xb(),g.Xb(),g.Yb(10,"button",6),g.Tb(11,"nb-icon",7),g.Xb(),g.Gc(12,K,5,2,"div",8),g.Yb(13,"mat-tree",9),g.Gc(14,$,3,3,"mat-tree-node",10),g.Gc(15,V,9,7,"mat-tree-node",11),g.Xb(),g.Tb(16,"div",12),g.Yb(17,"mat-menu",null,13),g.Gc(19,Z,6,0,"ng-template",14),g.Xb(),g.Tb(20,"span",null,15)),2&e){var n=g.vc(18);g.Fb(10),g.pc("nbContextMenu",t.items),g.Fb(2),g.pc("ngForOf",t.incomingFavoriteRequestList),g.Fb(1),g.pc("dataSource",t.dataSource)("treeControl",t.treeControl),g.Fb(2),g.pc("matTreeNodeDefWhen",t.hasChild),g.Fb(1),g.Dc("left",t.contextMenuPosition.x)("top",t.contextMenuPosition.y),g.pc("matMenuTriggerFor",n)}},directives:[x.b,y.a,m.i,m.o,k.l,p.a,p.f,b.d,b.e,b.a,m.d,m.f,m.c,F.a,w.b,w.j,w.m,m.e,S.a,I.g,O.a,k.m,p.e,p.h,p.g,k.k,N.a,P.a,b.b],styles:["button[nbTreeGridRowToggle][_ngcontent-%COMP%]{background:transparent;border:none;padding:0}.search-label[_ngcontent-%COMP%]{display:block}.search-input[_ngcontent-%COMP%]{background:transparent;color:#fff;padding:5px;font-size:12px;width:100%;margin-top:1rem;margin-bottom:1rem;width:78%;margin-left:1%}.addChannelButton[_ngcontent-%COMP%]{color:rgba(134,116,183,.7490196078431373);margin-left:5%;position:relative;top:1px;background-color:#45267d;border:1px solid;border-radius:5px;padding:4px;opacity:.7}.nb-column-name[_ngcontent-%COMP%]{width:80%}.nb-column-items[_ngcontent-%COMP%]{width:20%}.favoriteRequest[_ngcontent-%COMP%]{width:100%;overflow:hidden;white-space:nowrap;padding:10px;border-radius:5px;background:rgba(120,14,62,.6392156862745098);font-family:Ubuntu;font-size:14px;margin-bottom:5px}.favoriteRequestText[_ngcontent-%COMP%]{width:80%;cursor:pointer;overflow:hidden;width:66%;float:left;text-overflow:ellipsis;color:hsla(0,0%,100%,.7490196078431373)}.scanQRCode[_ngcontent-%COMP%]{font-size:37px;color:#315cdf;cursor:pointer}.scanQRCode[_ngcontent-%COMP%]:hover{color:#4a81e6}[_nghost-%COMP%]   nb-layout-header[_ngcontent-%COMP%]     nav{justify-content:flex-end}.mat-tree[_ngcontent-%COMP%], .mat-tree-node[_ngcontent-%COMP%]{background:transparent}.mat-tree-node[_ngcontent-%COMP%]{overflow:visible;cursor:move}.drop-above[_ngcontent-%COMP%]{border-top:10px solid #2196f3;margin-top:-10px}.drop-below[_ngcontent-%COMP%]{border-bottom:10px solid #2196f3;margin-bottom:-10px}.drop-center[_ngcontent-%COMP%]{background-color:#a9a9a9}.drag-start[_ngcontent-%COMP%]{background-color:#1565c0;color:#f0fff0}.treeNodeContainerFolder[_ngcontent-%COMP%]{background-color:rgba(131,119,230,.058823529411764705);padding:0 16px 0 0}.treeNodeContainerFolder[_ngcontent-%COMP%], .treeNodeContainerSingle[_ngcontent-%COMP%]{border-radius:5px;margin:0;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.treeNodeContainerSingle[_ngcontent-%COMP%]{background-color:rgba(69,39,128,.3686274509803922);padding:6px 10px 6px 15px}.mat-tree[_ngcontent-%COMP%]{width:227px;left:14px;top:190px;bottom:40px;position:fixed;overflow:scroll}.mat-tree[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px}.mat-tree[_ngcontent-%COMP%]::-webkit-scrollbar-track{box-shadow:inset 0 0 6px rgba(0,0,0,.3)}.mat-tree[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:rgba(78,132,229,.5607843137254902);outline:0}.mat-tree[_ngcontent-%COMP%]::-webkit-scrollbar-track{box-shadow:none!important}.emptyFolder[_ngcontent-%COMP%]{display:none}.mat-icon-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], .mat-icon-button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{line-height:20px}.qrScanWrapper[_ngcontent-%COMP%]{min-width:20px;max-height:80vh;max-width:37vw}.mat-tree[_ngcontent-%COMP%]{z-index:999;max-width:227px;left:-1px;padding-right:10px;position:relative;top:0;margin-bottom:40px}.nodeContent.station[_ngcontent-%COMP%], .nodeContent.unknown[_ngcontent-%COMP%]{position:relative;top:-1px}"]}),i}()}).call(this,a("tjlA").Buffer)},"8A8W":function(t,n,i){"use strict";i.r(n),i.d(n,"QDMessagesModule",(function(){return Ye}));var a,c=i("tyNb"),s=i("fXoL"),l=i("n2fA"),d=i("Witw"),u=i("aceb"),h=i("gvxT"),p=i("ofXK"),b=i("bTqV"),g=i("rk8u"),f=i("/on3"),v=((a=function(){function e(){r(this,e)}return o(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||a)},a.\u0275cmp=s.Mb({type:a,selectors:[["messages-channel-sidebar-left"]],decls:5,vars:0,consts:[["fullWidth",""],["tabIcon","activity-outline",1,"channelList"],["tabIcon","star-outline",1,"channelList","favoriteTab"]],template:function(e,t){1&e&&(s.Yb(0,"nb-tabset",0),s.Yb(1,"nb-tab",1),s.Tb(2,"messages-channel-list"),s.Xb(),s.Yb(3,"nb-tab",2),s.Tb(4,"messages-channel-favorites"),s.Xb(),s.Xb())},directives:[u.H,u.G,g.a,f.a],styles:[".favoriteTab[_ngcontent-%COMP%]{overflow:hidden!important;overflow-y:auto!important}"]}),a),m=i("Cjz3"),C=i("5+WD"),x=i("SS7q"),y=i("qFsG"),k=i("3Pt+"),F=["folder"],w=["folderEdit"],S=["participantEdit"];function I(e,t){if(1&e){var n=s.Zb();s.Yb(0,"nb-card"),s.Yb(1,"nb-card-header"),s.Ic(2,"Create Participant Folder"),s.Xb(),s.Yb(3,"nb-card-body",6),s.Yb(4,"div",7),s.Yb(5,"input",8),s.fc("ngModelChange",(function(e){return s.xc(n),s.jc().newFolderName=e})),s.Xb(),s.Xb(),s.Xb(),s.Yb(6,"nb-card-footer"),s.Yb(7,"button",9),s.fc("click",(function(){s.xc(n);var e=s.jc();return e.createFolder(e.newFolderName)})),s.Ic(8,"Create"),s.Xb(),s.Yb(9,"button",10),s.fc("click",(function(){return s.xc(n),s.jc().closePopup()})),s.Ic(10,"Cancel"),s.Xb(),s.Xb(),s.Xb()}if(2&e){var i=s.jc();s.Fb(5),s.pc("ngModel",i.newFolderName)}}function O(e,t){if(1&e){var n=s.Zb();s.Yb(0,"nb-card"),s.Yb(1,"nb-card-header"),s.Ic(2,"Edit Folder"),s.Xb(),s.Yb(3,"nb-card-body",6),s.Yb(4,"div",7),s.Yb(5,"input",11),s.fc("ngModelChange",(function(e){return s.xc(n),s.jc().editedFolderName=e})),s.Xb(),s.Xb(),s.Xb(),s.Yb(6,"nb-card-footer"),s.Yb(7,"button",9),s.fc("click",(function(){s.xc(n);var e=s.jc();return e.editFolder(e.editedFolderId,e.editedFolderName)})),s.Ic(8,"Create"),s.Xb(),s.Yb(9,"button",10),s.fc("click",(function(){return s.xc(n),s.jc().closePopup()})),s.Ic(10,"Cancel"),s.Xb(),s.Xb(),s.Xb()}if(2&e){var i=s.jc();s.Fb(5),s.pc("ngModel",i.editedFolderName)}}function N(e,t){if(1&e){var n=s.Zb();s.Yb(0,"nb-card"),s.Yb(1,"nb-card-header"),s.Ic(2,"Edit Participant"),s.Xb(),s.Yb(3,"nb-card-body",6),s.Yb(4,"div",7),s.Yb(5,"input",12),s.fc("ngModelChange",(function(e){return s.xc(n),s.jc().editedParticipantName=e})),s.Xb(),s.Xb(),s.Xb(),s.Yb(6,"nb-card-footer"),s.Yb(7,"button",9),s.fc("click",(function(){s.xc(n);var e=s.jc();return e.editParticipant(e.editedParticipantId,e.editedParticipantName)})),s.Ic(8,"Create"),s.Xb(),s.Yb(9,"button",10),s.fc("click",(function(){return s.xc(n),s.jc().closePopup()})),s.Ic(10,"Cancel"),s.Xb(),s.Xb(),s.Xb()}if(2&e){var i=s.jc();s.Fb(5),s.pc("ngModel",i.editedParticipantName)}}function P(e,t){if(1&e){var n=s.Zb();s.Yb(0,"nb-icon",21),s.fc("click",(function(){s.xc(n);var e=s.jc(2);return e.openPopup(e.folderPop)})),s.Xb()}}function M(e,t){if(1&e){var n=s.Zb();s.Yb(0,"nb-icon",22),s.fc("click",(function(){s.xc(n);var e=s.jc().$implicit;return s.jc().removeFolder(e.id)})),s.Xb()}}function X(e,t){if(1&e){var n=s.Zb();s.Yb(0,"div",23),s.fc("click",(function(e){return s.xc(n),s.jc(2).clickParticipant(e)})),s.Yb(1,"span",24),s.fc("click",(function(){s.xc(n);var e=t.$implicit;return s.jc(2).openSocialProfile(e.name,e.pubKey)})),s.Ic(2),s.Xb(),s.Yb(3,"nb-icon",25),s.fc("click",(function(){s.xc(n);var e=t.$implicit,i=s.jc().$implicit,a=s.jc();return a.openPopup(a.participantEditPop,i.id,e.pubKey)})),s.Xb(),s.Xb()}if(2&e){var i=t.$implicit,a=s.jc(2);s.Ib("item-box participantEntry ",a.isOnline(i.pubKey),""),s.Fb(2),s.Jc(i.name)}}function j(e,t){if(1&e){var n=s.Zb();s.Yb(0,"div",13),s.Yb(1,"div",14),s.Yb(2,"div",15),s.Ic(3),s.Gc(4,P,1,0,"nb-icon",16),s.Gc(5,M,1,0,"nb-icon",17),s.Yb(6,"nb-icon",18),s.fc("click",(function(){s.xc(n);var e=t.$implicit,i=s.jc();return i.openPopup(i.folderEditPop,e.id)})),s.Xb(),s.Xb(),s.Yb(7,"div",19),s.fc("cdkDropListDropped",(function(e){return s.xc(n),s.jc().drop(e)})),s.Gc(8,X,4,4,"div",20),s.Xb(),s.Xb(),s.Xb()}if(2&e){var i=t.$implicit,a=s.jc();s.Fb(3),s.Kc("",i.name," "),s.Fb(1),s.pc("ngIf",i.participants.length>0||"others"==i.id),s.Fb(1),s.pc("ngIf",0==i.participants.length&&"others"!=i.id),s.Fb(2),s.qc("id",i.id),s.pc("cdkDropListData",i.participants)("cdkDropListConnectedTo",a.connectedTo),s.Fb(1),s.pc("ngForOf",i.participants)}}function Y(e,t){1&e&&(s.Yb(0,"div",26),s.Ic(1," Waiting... "),s.Xb())}var q,T=((q=function(){function t(e,n,i,a,o,c){r(this,t),this.ngZone=e,this.router=n,this.cd=i,this.q=a,this.ui=o,this.dialog=c,this.channel="NoChannelSelected",this.folders=[],this.connectedTo=[],this.channelParticipantListArray=[],this.popupRef=[],this.dev=!1,this.noChannelSelected="NoChannelSelected",this.dev=!1}return o(t,[{key:"clickParticipant",value:function(e){this.dev&&console.log(e)}},{key:"isOnline",value:function(e){return this.q.os.channel.isPeerOnline(e)}},{key:"sortFoldersByName",value:function(e){e.sort((function(e,t){return e.name.localeCompare(t.name)}));var t=e.filter((function(e){return"others"==e.id}));return e=e.filter((function(e){return"others"!=e.id})),void 0!==t[0]&&e.push(t[0]),e}},{key:"drop",value:function(e){e.previousContainer===e.container?Object(C.d)(e.container.data,e.previousIndex,e.currentIndex):Object(C.e)(e.previousContainer.data,e.container.data,e.previousIndex,e.currentIndex),this.q.os.channel.setParticipantFolders(this.channel,this.folders)}},{key:"ngOnDestroy",value:function(){clearInterval(this.uiCheck),this.selectedChannelSub.unsubscribe()}},{key:"getFolderNameForId",value:function(e){for(var t=0;t<this.folders.length;t++)if(this.folders[t].id==e)return this.folders[t].name}},{key:"openSocialProfile",value:function(e,t){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,a=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("Anonymous"!=e){n.next=2;break}return n.abrupt("return",!1);case 2:return n.next=4,this.q.os.social.profile.getByChannelPubKey(t);case 4:i=(i=n.sent).key.pubKey,this.dev&&console.log(i),this.ngZone.run((function(){return a.router.navigate(["/social/profile/"+i])}));case 6:case"end":return n.stop()}}),n,this)})))}},{key:"getParticipantNameForId",value:function(e){for(var t=0;t<this.folders.length;t++)for(var n=0;n<this.folders[t].participants.length;n++)if(this.folders[t].participants[n].pubKey==e)return this.folders[t].participants[n].name}},{key:"createFolder",value:function(e){this.folders.push({id:Object(x.a)(),name:e,participants:[]}),this.folders=this.sortFoldersByName(this.folders),this.connectedTo=[];for(var t=0;t<this.folders.length;t++)this.connectedTo.push(this.folders[t].id);this.q.os.channel.setParticipantFolders(this.channel,this.folders),this.closePopup()}},{key:"removeFolder",value:function(e){this.folders=this.sortFoldersByName(this.folders.filter((function(t){return t.id!=e})));for(var t=0;t<this.folders.length;t++)this.connectedTo.push(this.folders[t].id);this.q.os.channel.setParticipantFolders(this.channel,this.folders)}},{key:"editFolder",value:function(e,t){this.connectedTo=[];for(var n=0;n<this.folders.length;n++)this.folders[n].id==e&&(this.folders[n].name=this.editedFolderName);this.folders=this.sortFoldersByName(this.folders);for(var i=0;i<this.folders.length;i++)this.connectedTo.push(this.folders[i].id);this.q.os.channel.setParticipantFolders(this.channel,this.folders),this.closePopup()}},{key:"editParticipant",value:function(e,t){this.connectedTo=[];for(var n=0;n<this.folders.length;n++){for(var i=0;i<this.folders[n].participants.length;i++)this.folders[n].participants[i].pubKey==this.editedParticipantId&&(this.folders[n].participants[i].nick=this.editedParticipantName);this.connectedTo.push(this.folders[n].id)}this.q.os.channel.setParticipantFolders(this.channel,this.folders),this.closePopup()}},{key:"openPopup",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";""!=t&&(this.editedFolderId=t,this.editedFolderName=this.getFolderNameForId(t)),""!=n&&(this.editedParticipantId=n,this.editedParticipantName=this.getParticipantNameForId(n)),this.popupRef.push(this.dialog.open(e,{context:"this is some additional data passed to dialog"}))}},{key:"closePopup",value:function(){console.log("close toggled"),this.popupRef[this.popupRef.length-1].close(),this.popupRef.pop()}},{key:"initRefresh",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.q.os.utilities.delay(2e3);case 2:return this.cd.detectChanges(),t.next=5,this.q.os.utilities.delay(2e3);case 5:return this.cd.detectChanges(),t.next=8,this.q.os.utilities.delay(2e3);case 8:if(this.cd.detectChanges(),t.t0=e,!t.t0){t.next=14;break}return t.next=13,this.q.os.utilities.delay(2e3);case 13:this.initRefresh(!1);case 14:case"end":return t.stop()}}),t,this)})))}},{key:"initProcess",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i,a,o,r,c,s,l,d,u,h,p,b,g,f,v,m,C,x,y,k,F,w,S,I,O,N,P=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.channel=this.q.os.channel.getSelected(),n=this.channel,i=!1,"NoChannelSelected"==n){t.next=117;break}if(t.prev=3,void 0!==(a=this.q.os.ocean.dolphin.getChannelParticipantList(n)).cList){t.next=7;break}throw this.q.os.channel.sayHi(n),i=!0,"no list";case 7:if(o=a.cList.split(","),r=o,this.connectedTo=[],this.folders=[],!(o.length>0)){t.next=12;break}return t.delegateYield(regeneratorRuntime.mark((function e(){var t,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=P.q.os.channel.getParticipantFolders(n),P.folders=[],!(t.length>0)){e.next=10;break}i=regeneratorRuntime.mark((function e(i){var a,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=regeneratorRuntime.mark((function e(a){var r,c,s,l,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t[i].participants[a].nick||""==t[i].participants[a].nick){e.next=4;break}t[i].participants[a].name=t[i].participants[a].nick,e.next=32;break;case 4:return e.prev=4,console.log("ChannelParticipantList: Getting Profile For Foldered Participant..."),e.next=8,P.q.os.social.profile.getByChannelPubKey(t[i].participants[a].pubKey);case 8:r=e.sent,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),console.log(e.t0);case 14:if(void 0===r||void 0===r.alias){e.next=32;break}if(c=!1,s=!1,!(n.indexOf("qprivatedch")>-1&&P.q.os.social.profile.isRequestedFavorite(r.key.pubKey))){e.next=20;break}P.q.os.social.profile.addFavorite(r.key.pubKey),c=!0,P.q.os.social.profile.removeFavoriteRequest(r.key.pubKey),e.next=31;break;case 20:if(!P.q.os.social.profile.isRequestedFavorite(r.key.pubKey)){e.next=31;break}return l=P.q.os.social.profile.getRequestedFavoriteChannel(r.key.pubKey),e.t1=P.q.os.channel.invite.create(l,1),e.next=25,P.q.os.social.profile.getMyProfileId();case 25:e.t2=e.sent,e.t3=l,e.t4={invite:e.t1,pubKey:e.t2,channel:e.t3},e.t5=t[i].participants[a].pubKey,d={message:e.t4,toChannelPubKey:e.t5},P.isOnline(d.toChannelPubKey)&&P.q.os.channel.publish(P.channel,d,"REQUEST_FAVORITE"),s=!0;case 31:t[i].participants[a].name=r.alias,t[i].participants[a].isFavorite=c,t[i].participants[a].isRequestedFavorite=s;case 32:o=o.filter((function(e){return e!=t[i].participants[a].pubKey}));case 33:case"end":return e.stop()}}),e,null,[[4,11]])})),r=0;case 2:if(!(r<t[i].participants.length)){e.next=7;break}return e.delegateYield(a(r),"t0",4);case 4:r++,e.next=2;break;case 7:case"end":return e.stop()}}),e)})),a=0;case 4:if(!(a<t.length)){e.next=9;break}return e.delegateYield(i(a),"t0",6);case 6:a++,e.next=4;break;case 9:P.folders=t;case 10:case"end":return e.stop()}}),e)}))(),"t0",10);case 10:t.next=13;break;case 12:i||(this.q.os.channel.sayHi(n),i=!0);case 13:c=[],this.dev&&console.log(o),s=0;case 16:if(!(s<o.length)){t.next=51;break}return l=void 0,t.prev=18,this.dev&&console.log("ChannelParticipantList: Getting Profile For Unfoldered Participant..."),t.next=22,this.q.os.social.profile.getByChannelPubKey(o[s]);case 22:l=t.sent,this.dev&&console.log(o[s],l),t.next=29;break;case 26:t.prev=26,t.t1=t.catch(18),console.log(t.t1);case 29:if(this.dev&&console.log(l),void 0===l||void 0===l.alias){t.next=47;break}if(d=!1,u=!1,!(n.indexOf("qprivatedch")>-1&&this.q.os.social.profile.isRequestedFavorite(l.key.pubKey))){t.next=35;break}this.q.os.social.profile.addFavorite(l.key.pubKey),d=!0,this.q.os.social.profile.removeFavoriteRequest(l.key.pubKey),t.next=44;break;case 35:if(!this.q.os.social.profile.isRequestedFavorite(l.key.pubKey)){t.next=44;break}return h=this.q.os.social.profile.getRequestedFavoriteChannel(l.key.pubKey),t.t2=this.q.os.channel.invite.create(h,1),t.next=40,this.q.os.social.profile.getMyProfileId();case 40:t.t3=t.sent,t.t4=h,p={invite:t.t2,pubKey:t.t3,channel:t.t4},this.isOnline(o[s])&&this.q.os.channel.publish(this.channel,{message:p,toChannelPubKey:o[s]},"REQUEST_FAVORITE"),u=!0;case 44:c.push({pubKey:o[s],name:l.alias,isFavorite:d,isRequestedFavorite:u}),t.next=48;break;case 47:c.push({pubKey:o[s],name:"Anonymous"});case 48:s++,t.next=16;break;case 51:for(b=!1,g=0;g<this.folders.length;g++)"others"==this.folders[g].id&&(this.folders[g].participants=this.folders[g].participants.concat(c),b=!0);b||this.folders.push({id:"others",name:"Crowd",participants:c}),this.folders=this.sortFoldersByName(this.folders),f=e(this.folders);try{for(f.s();!(v=f.n()).done;)m=v.value,this.connectedTo.push(m.id)}catch(M){f.e(M)}finally{f.f()}return C=(new Date).getTime(),C-=18e4,t.next=60,this.q.os.social.profile.isPublic();case 60:if(t.t5=t.sent,!t.t5){t.next=63;break}t.t5=void 0===this.sharedPublicSocialTimestamp||this.sharedPublicSocialTimestamp<C;case 63:if(!t.t5){t.next=112;break}x=!1,console.log("CPL: Checking who doesnt have my Social Profile..."),y=e(r),t.prev=67,y.s();case 69:if((k=y.n()).done){t.next=81;break}return F=k.value,t.next=73,this.q.os.social.profile.hasMySocial(F);case 73:if(t.t6=!t.sent,!t.t6){t.next=76;break}t.t6=this.isOnline(F);case 76:if(t.t7=t.t6,!t.t7){t.next=79;break}x=!0;case 79:t.next=69;break;case 81:t.next=86;break;case 83:t.prev=83,t.t8=t.catch(67),y.e(t.t8);case 86:return t.prev=86,y.f(),t.finish(86);case 89:if(!x){t.next=112;break}return console.log("CPL: Sharing Social Profile..."),t.next=93,this.q.os.social.profile.getMyProfile();case 93:return w=t.sent,S=w.key.privKey,I={alias:w.alias,fullName:w.fullName,about:w.about,private:w.private,key:{pubKey:w.key.pubKey}},O={},t.prev=97,t.next=100,this.q.os.social.timeline.getLatestRef(w.key.pubKey);case 100:O=t.sent,t.next=106;break;case 103:t.prev=103,t.t9=t.catch(97),console.log(t.t9);case 106:return void 0!==O.qHash&&void 0!==O.whistle&&(I.timeline=O),console.log("SHARING"),this.dev&&console.log(S),t.next=109,this.q.os.crypto.ec.sign(I,S);case 109:t.t10=t.sent,N={message:t.t10},this.dev&&console.log("qD Messages ChannelParticipantList: Publishing...",JSON.parse(JSON.stringify(N))),this.q.os.channel.publish(this.channel,N,"SHARE_PUBLIC_SOCIAL"),this.sharedPublicSocialTimestamp=(new Date).getTime();case 112:t.next=117;break;case 114:t.prev=114,t.t11=t.catch(3),"no list"==t.t11&&(this.folders=[]),console.log(t.t11);case 117:return t.abrupt("return",(this.cd.detectChanges(),!0));case 118:case"end":return t.stop()}}),t,this,[[3,114],[18,26],[67,83,86,89],[97,103]])})))}},{key:"ngOnInit",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.q.isReady()&&this.q.os.isSignedIn()){e.next=5;break}return e.next=3,this.ui.delay(1e3);case 3:e.next=0;break;case 5:return this.selectedChannelSub=this.q.os.channel.onSelect().subscribe((function(e){console.log("ChannelParticipantList: changed channel"),t.initProcess(),t.channel=e,console.log("App: Selected Channel: >>"+t.channel+"<<"),console.log("App: noChannelSelected: >>"+t.noChannelSelected+"<<")})),this.uiCheck=setInterval((function(){t.initProcess()}),2e4),e.next=9,this.initProcess();case 9:case"end":return e.stop()}}),e,this)})))}}]),t}()).\u0275fac=function(e){return new(e||q)(s.Sb(s.C),s.Sb(c.c),s.Sb(s.h),s.Sb(h.a),s.Sb(d.a),s.Sb(u.l))},q.\u0275cmp=s.Mb({type:q,selectors:[["messages-channel-participant-list"]],viewQuery:function(e,t){var n;1&e&&(s.Mc(F,!0),s.Mc(w,!0),s.Mc(S,!0)),2&e&&(s.uc(n=s.gc())&&(t.folderPop=n.first),s.uc(n=s.gc())&&(t.folderEditPop=n.first),s.uc(n=s.gc())&&(t.participantEditPop=n.first))},decls:10,vars:2,consts:[["folder",""],["folderEdit",""],["participantEdit",""],["class","col-md-3",4,"ngFor","ngForOf"],["class","syncingItem",4,"ngIf"],[1,"spacer"],[2,"color","goldenrod"],[2,"padding","20px","color","white !important"],["matInput","","placeholder","Folder Name","value","","name","newFolderName",2,"color","black","background-color","goldenrod","padding","7px",3,"ngModel","ngModelChange"],["mat-stroked-button","","color","primary",2,"margin-right","20px","border","1px solid #ffffff24",3,"click"],["mat-stroked-button","","color","primary",2,"border","1px solid #ffffff24",3,"click"],["matInput","","placeholder","Folder Name","value","","name","editedFolderName",2,"color","black","background-color","goldenrod","padding","7px",3,"ngModel","ngModelChange"],["matInput","","placeholder","Participant Name","value","","name","editedParticipantName",2,"color","black","background-color","goldenrod","padding","7px",3,"ngModel","ngModelChange"],[1,"col-md-3"],[1,"drag-container"],[1,"section-heading"],["icon","plus-outline","class","folderIcon",3,"click",4,"ngIf"],["icon","close-outline","class","folderIcon",3,"click",4,"ngIf"],["icon","edit-2-outline",1,"folderIcon","editIcon",3,"click"],["cdkDropList","",1,"item-list",3,"id","cdkDropListData","cdkDropListConnectedTo","cdkDropListDropped"],["cdkDrag","",3,"class","click",4,"ngFor","ngForOf"],["icon","plus-outline",1,"folderIcon",3,"click"],["icon","close-outline",1,"folderIcon",3,"click"],["cdkDrag","",3,"click"],[1,"participantName",3,"click"],["icon","options-2-outline",1,"participantIcon","participantSettingsIcon",3,"click"],[1,"syncingItem"]],template:function(e,t){1&e&&(s.Gc(0,I,11,1,"ng-template",null,0,s.Hc),s.Gc(2,O,11,1,"ng-template",null,1,s.Hc),s.Gc(4,N,11,1,"ng-template",null,2,s.Hc),s.Gc(6,j,9,7,"div",3),s.Gc(7,Y,2,0,"div",4),s.Yb(8,"div",5),s.Ic(9,"\xa0"),s.Xb()),2&e&&(s.Fb(6),s.pc("ngForOf",t.folders),s.Fb(1),s.pc("ngIf",0===t.folders.length))},directives:[p.l,p.m,u.d,u.f,u.c,y.a,k.b,k.j,k.m,u.e,b.a,u.o,C.b,C.a],styles:[".section-heading[_ngcontent-%COMP%]{padding:5px 10px}.drag-container[_ngcontent-%COMP%]{margin:0 25px 25px 0}.item-list[_ngcontent-%COMP%]{min-height:60px;border-radius:4px;display:block}.participant[_ngcontent-%COMP%]{background:#0084ff;background-image:linear-gradient(319deg,#fce055,#256eff 37%,#46237a);color:#fff;margin:0}.participantEntry.false[_ngcontent-%COMP%]{opacity:.3}.item-box[_ngcontent-%COMP%], .participantName[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;width:100%}.item-box[_ngcontent-%COMP%]{font-size:14px;background:#0084ff;background-image:linear-gradient(319deg,#fce055,#256eff 37%,#46237a);color:#fff;font-family:MONOSPACE;font-size:11px;padding:6px 10px;border:0;display:flex;flex-direction:row;align-items:center;justify-content:space-between;box-sizing:border-box;cursor:pointer;border-radius:8px;margin:0 0 5px;font-family:Ubuntu;font-size:12px}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);border-radius:8px}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%], .item-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .item-box[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.drag-container[_ngcontent-%COMP%]{width:400px;max-width:100%;margin:0 0 10px;display:inline-block;vertical-align:top;background-color:rgba(233,236,239,.0196078431372549);padding:15px;border-radius:10px}.section-heading[_ngcontent-%COMP%]{padding-bottom:9px;padding-left:7px;padding-top:0;font-size:15px;font-weight:700;color:#d6d649}.spacer[_ngcontent-%COMP%]{min-height:40px}.editIcon[_ngcontent-%COMP%]{margin-right:10px}.folderIcon[_ngcontent-%COMP%], .participantIcon[_ngcontent-%COMP%]{float:right;font-size:17px;color:#3375f6;cursor:pointer}.syncingItem[_ngcontent-%COMP%]{position:relative;top:20px;text-align:center;color:red}"]}),q),E=i("jhN1"),R=i("kmnG"),D=i("d3UM"),B=i("FKr1"),L=i("UXJo"),_=["qrCode"];function A(e,t){if(1&e){var n=s.Zb();s.Yb(0,"nb-card"),s.Yb(1,"nb-card-header"),s.Ic(2,"Scan QR"),s.Xb(),s.Yb(3,"nb-card-body",13),s.Yb(4,"div"),s.Yb(5,"div",14),s.Tb(6,"img",15),s.Xb(),s.Xb(),s.Xb(),s.Yb(7,"nb-card-footer"),s.Yb(8,"button",16),s.fc("click",(function(){return s.xc(n),s.jc().closePopup()})),s.Ic(9,"Close"),s.Xb(),s.Xb(),s.Xb()}if(2&e){var i=s.jc();s.Fb(6),s.pc("src",i.qrCodeURLSafe,s.zc)}}function K(e,t){if(1&e){var n=s.Zb();s.Yb(0,"li",17),s.Yb(1,"div",18),s.Ic(2),s.Xb(),s.Yb(3,"div",19),s.Ic(4),s.Xb(),s.Tb(5,"nb-icon",20),s.Yb(6,"nb-icon",21),s.fc("click",(function(){s.xc(n);var e=t.$implicit;return s.jc().showQR(e.link)})),s.Xb(),s.Yb(7,"nb-icon",22),s.fc("click",(function(){s.xc(n);var e=t.$implicit;return s.jc().removeInviteCode(e.link)})),s.Xb(),s.Xb()}if(2&e){var i=t.$implicit;s.Fb(2),s.Lc(" ",i.used," / ",i.max," "),s.Fb(2),s.Kc(" ",i.link," "),s.Fb(1),s.pc("cdkCopyToClipboard",i.link)}}function G(e,t){if(1&e){var n=s.Zb();s.Yb(0,"button",23),s.fc("click",(function(){return s.xc(n),s.jc().deleteCurrentChannel()})),s.Ic(1,"Remove Channel"),s.Xb()}}function z(e,t){if(1&e){var n=s.Zb();s.Yb(0,"button",23),s.fc("click",(function(){return s.xc(n),s.jc().removeFromFavoritesByCurrentChannel()})),s.Ic(1,"Remove From Favorites"),s.Xb()}}var H,$,V=(($=function(){function e(t,n,i,a,o,c){r(this,e),this.cd=t,this._sanitizer=n,this.ui=i,this.dialog=a,this.nbMenuService=o,this.q=c,this.challengeFlowFlag=0,this.newInviteCodeMax=5,this.isOwner=!1,this.includeFolderStructure=1,this.channelInviteCodes=[],this.selectedChannel="NoChannelSelected",this.noChannelSelected="NoChannelSelected"}return o(e,[{key:"newInviteCodeMaxChanged",value:function(e){}},{key:"generateQR",value:function(e){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(e),t.t0=this._sanitizer,t.next=4,this.q.os.utilities.qr.generate(e);case 4:t.t1=t.sent,this.qrCodeURLSafe=t.t0.bypassSecurityTrustUrl.call(t.t0,t.t1);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"generateInviteCode",value:function(){var e=this.selectedChannel;1==this.includeFolderStructure?this.q.os.channel.invite.create(e,this.newInviteCodeMax,!0):this.q.os.channel.invite.create(e,this.newInviteCodeMax);var t=this.q.os.ocean.dolphin.getInviteCodes(this.selectedChannel);this.channelInviteCodes=[],void 0!==t&&void 0!==t.items&&(this.channelInviteCodes=t.items)}},{key:"openPopup",value:function(e){this.popupRef=this.dialog.open(e,{context:"this is some additional data passed to dialog"})}},{key:"closePopup",value:function(){this.popupRef.close()}},{key:"showQR",value:function(e){this.generateQR(e),this.openPopup(this.qrCode)}},{key:"removeInviteCode",value:function(e){this.q.os.channel.invite.remove(this.selectedChannel,e),this.channelInviteCodes=[];var t=this.q.os.ocean.dolphin.getInviteCodes(this.selectedChannel);void 0!==t&&void 0!==t.items&&(this.channelInviteCodes=t.items)}},{key:"newInviteExportFoldersChanged",value:function(e){}},{key:"copyToClipboard",value:function(e){console.log(e)}},{key:"ngOnDestroy",value:function(){this.selectedChannelSub.unsubscribe()}},{key:"initChannel",value:function(e){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.selectedChannel=e,console.log("Channel-Settings: Selected Channel: >>"+this.selectedChannel+"<<"),console.log("Channel-Settings: noChannelSelected: >>"+this.noChannelSelected+"<<"),this.selectedChannel.indexOf("-----")>-1&&(this.isOwner=this.q.os.ocean.dolphin.isOwner(this.selectedChannel),this.channelInviteCodes=[],void 0!==(n=this.q.os.ocean.dolphin.getInviteCodes(this.selectedChannel))&&void 0!==n.items&&(this.channelInviteCodes=n.items),this.challengeFlowFlag=this.q.os.channel.challenge.isEnabled()),this.cd.detectChanges();case 2:case"end":return t.stop()}}),t,this)})))}},{key:"ngOnInit",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.q.isReady()){e.next=5;break}return e.next=3,this.ui.delay(1e3);case 3:e.next=0;break;case 5:this.initChannel(this.q.os.channel.getSelected()),this.selectedChannelSub=this.q.os.channel.onSelect().subscribe((function(e){t.initChannel(e)}));case 6:case"end":return e.stop()}}),e,this)})))}},{key:"challengeFlowFlagChanged",value:function(){var e=this.challengeFlowFlag,t=this.q.os.channel.getSelected();e?this.q.os.channel.challenge.enable(t):this.q.os.channel.challenge.disable(t)}},{key:"deleteCurrentChannel",value:function(){this.q.os.channel.remove(this.selectedChannel),this.q.os.channel.select("NoChannelSelected")}},{key:"removeFromFavoritesByCurrentChannel",value:function(){var e=this.selectedChannel;this.q.os.social.profile.removeFavorite(e.split("-----")[0].split("-")[1]),this.q.os.social.profile.removeFavorite(e.split("-----")[0].split("-")[2]),this.q.os.channel.remove(e),this.q.os.channel.removeFromNameList(e),this.q.os.channel.select("NoChannelSelected")}}]),e}()).\u0275fac=function(e){return new(e||$)(s.Sb(s.h),s.Sb(E.b),s.Sb(d.a),s.Sb(u.l),s.Sb(u.y),s.Sb(h.a))},$.\u0275cmp=s.Mb({type:$,selectors:[["messages-channel-settings"]],viewQuery:function(e,t){var n;1&e&&s.Mc(_,!0),2&e&&s.uc(n=s.gc())&&(t.qrCode=n.first)},decls:51,vars:21,consts:[["qrCode",""],[3,"hidden"],[1,"channelSettingsOption"],[2,"width","24%","padding","0"],[3,"value","valueChange","selectionChange"],[3,"value"],[1,"channelSettingsOption","mTop10"],[2,"margin-bottom","4px","height","28px"],[2,"width","19%"],[2,"width","24%"],["nbButton","","size","small",1,"generateInviteCodeButton",2,"color","#99aca2",3,"click"],["class","inviteCodeListItem",4,"ngFor","ngForOf"],["mat-stroked-button","","color","primary","class","defaultSettingsButton removeButton",3,"click",4,"ngIf"],[2,"margin","10px","color","goldenrod"],[1,"qrCodeWrapper"],["alt","",1,"qrCodeShowGenerate",3,"src"],["mat-stroked-button","","color","primary",2,"border","1px solid #ffffff24",3,"click"],[1,"inviteCodeListItem"],[1,"inviteCodeUsers"],[1,"inviteCodeItem"],["icon","copy-outline",1,"inviteCodeCopy",3,"cdkCopyToClipboard"],["icon","camera-outline",1,"deleteCode",3,"click"],["icon","trash-2-outline",1,"deleteCode",3,"click"],["mat-stroked-button","","color","primary",1,"defaultSettingsButton","removeButton",3,"click"]],template:function(e,t){1&e&&(s.Gc(0,A,10,1,"ng-template",null,0,s.Hc),s.Yb(2,"div",1),s.Yb(3,"p",2),s.Ic(4," Challenge"),s.Xb(),s.Yb(5,"mat-form-field",3),s.Yb(6,"mat-select",4),s.fc("valueChange",(function(e){return t.challengeFlowFlag=e}))("selectionChange",(function(){return t.challengeFlowFlagChanged()})),s.Yb(7,"mat-option",5),s.Ic(8," On "),s.Xb(),s.Yb(9,"mat-option",5),s.Ic(10," Off "),s.Xb(),s.Xb(),s.Xb(),s.Yb(11,"p",6),s.Ic(12," Invite Codes"),s.Xb(),s.Yb(13,"div",7),s.Ic(14," Include Folders: "),s.Yb(15,"mat-form-field",8),s.Yb(16,"mat-select",4),s.fc("valueChange",(function(e){return t.includeFolderStructure=e}))("selectionChange",(function(e){return t.newInviteExportFoldersChanged(e.value)})),s.Yb(17,"mat-option",5),s.Ic(18," On "),s.Xb(),s.Yb(19,"mat-option",5),s.Ic(20," Off "),s.Xb(),s.Xb(),s.Xb(),s.Xb(),s.Yb(21,"div"),s.Ic(22," Max: "),s.Yb(23,"mat-form-field",9),s.Yb(24,"mat-select",4),s.fc("valueChange",(function(e){return t.newInviteCodeMax=e}))("selectionChange",(function(e){return t.newInviteCodeMaxChanged(e.value)})),s.Yb(25,"mat-option",5),s.Ic(26," 1 "),s.Xb(),s.Yb(27,"mat-option",5),s.Ic(28," 5 "),s.Xb(),s.Yb(29,"mat-option",5),s.Ic(30," 10 "),s.Xb(),s.Yb(31,"mat-option",5),s.Ic(32," 20 "),s.Xb(),s.Yb(33,"mat-option",5),s.Ic(34," 40 "),s.Xb(),s.Yb(35,"mat-option",5),s.Ic(36," 80 "),s.Xb(),s.Yb(37,"mat-option",5),s.Ic(38," 100 "),s.Xb(),s.Yb(39,"mat-option",5),s.Ic(40," 1k "),s.Xb(),s.Yb(41,"mat-option",5),s.Ic(42," 1m "),s.Xb(),s.Yb(43,"mat-option",5),s.Ic(44," 10m "),s.Xb(),s.Xb(),s.Xb(),s.Yb(45,"button",10),s.fc("click",(function(){return t.generateInviteCode()})),s.Ic(46," Generate "),s.Xb(),s.Xb(),s.Yb(47,"ul"),s.Gc(48,K,8,4,"li",11),s.Xb(),s.Xb(),s.Gc(49,G,2,0,"button",12),s.Gc(50,z,2,0,"button",12)),2&e&&(s.Fb(2),s.pc("hidden",!t.isOwner||t.selectedChannel.indexOf("qprivatedch")>-1),s.Fb(4),s.pc("value",t.challengeFlowFlag),s.Fb(1),s.pc("value",1),s.Fb(2),s.pc("value",0),s.Fb(7),s.pc("value",t.includeFolderStructure),s.Fb(1),s.pc("value",1),s.Fb(2),s.pc("value",0),s.Fb(5),s.pc("value",t.newInviteCodeMax),s.Fb(1),s.pc("value",1),s.Fb(2),s.pc("value",5),s.Fb(2),s.pc("value",10),s.Fb(2),s.pc("value",20),s.Fb(2),s.pc("value",40),s.Fb(2),s.pc("value",80),s.Fb(2),s.pc("value",100),s.Fb(2),s.pc("value",1e3),s.Fb(2),s.pc("value",1e6),s.Fb(2),s.pc("value",1e7),s.Fb(5),s.pc("ngForOf",t.channelInviteCodes),s.Fb(1),s.pc("ngIf",t.selectedChannel.indexOf("qprivatedch")<0),s.Fb(1),s.pc("ngIf",t.selectedChannel.indexOf("qprivatedch")>-1))},directives:[R.b,D.a,B.g,p.l,p.m,u.d,u.f,u.c,u.e,b.a,u.o,L.a],styles:[".channelSettingsOption[_ngcontent-%COMP%]{color:#98aba2!important;margin-bottom:0}.inviteCodeListItem[_ngcontent-%COMP%]{padding:0!important;margin:0!important;width:100%}.inviteCodeUsers[_ngcontent-%COMP%]{width:30%;overflow:hidden;text-overflow:ellipsis}.inviteCodeItem[_ngcontent-%COMP%], .inviteCodeUsers[_ngcontent-%COMP%]{float:left}.inviteCodeItem[_ngcontent-%COMP%]{margin-left:5px;width:30%;margin-right:5px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.deleteCode[_ngcontent-%COMP%]{margin-left:5px}.deleteCode[_ngcontent-%COMP%], .inviteCodeCopy[_ngcontent-%COMP%]{cursor:pointer}.generateInviteCodeButton[_ngcontent-%COMP%]{margin-bottom:16px;color:#2a64ef;height:22px;width:37%;margin-top:5px;position:relative;top:0;margin-left:15px;background-color:transparent;border:1px solid;opacity:.7;font-size:13px}.mat-form-field-infix[_ngcontent-%COMP%]{padding:0}.qrCodeShowGenerate[_ngcontent-%COMP%]{float:left;display:block;min-width:31px;max-height:70vh;max-width:80vw}removeButton[_ngcontent-%COMP%]{margin-right:10px;margin-top:20px;color:rgba(241,79,49,.6705882352941176);border:1px solid rgba(241,79,49,.5686274509803921)!important}"]}),$),Z=((H=function(){function e(){r(this,e)}return o(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||H)},H.\u0275cmp=s.Mb({type:H,selectors:[["messages-channel-sidebar-right"]],decls:6,vars:0,consts:[["fullWidth",""],["tabIcon","people-outline",1,"channelParticipantList",2,"overflow-x","hidden","padding-top","12px"],["tabIcon","bell-outline"],["tabIcon","settings-outline",1,"channelSettingsTab"]],template:function(e,t){1&e&&(s.Yb(0,"nb-tabset",0),s.Yb(1,"nb-tab",1),s.Tb(2,"messages-channel-participant-list"),s.Xb(),s.Tb(3,"nb-tab",2),s.Yb(4,"nb-tab",3),s.Tb(5,"messages-channel-settings"),s.Xb(),s.Xb())},directives:[u.H,u.G,T,V],styles:[".channelSettingsTab[_ngcontent-%COMP%]{padding-top:20px}"]}),H);function W(e,t){if(1&e){var n=s.Zb();s.Yb(0,"button",12),s.fc("click",(function(){return s.xc(n),s.jc(2).lockSideBar("right",!1)})),s.Ic(1,"Lock Panel"),s.Xb()}}function Q(e,t){if(1&e){var n=s.Zb();s.Yb(0,"button",12),s.fc("click",(function(){return s.xc(n),s.jc(2).lockSideBar("right",!0)})),s.Ic(1,"Float Panel"),s.Xb()}}function J(e,t){if(1&e){var n=s.Zb();s.Yb(0,"nb-sidebar",9),s.Gc(1,W,2,0,"button",10),s.Gc(2,Q,2,0,"button",10),s.Yb(3,"button",11),s.fc("click",(function(){return s.xc(n),s.jc().toggleSideBar("right")})),s.Ic(4,"Hide Panel"),s.Xb(),s.Tb(5,"messages-channel-sidebar-right"),s.Xb()}if(2&e){var i=s.jc();s.pc("fixed",i.sideBarFixed.right),s.Fb(1),s.pc("ngIf",i.sideBarFixed.right),s.Fb(1),s.pc("ngIf",!i.sideBarFixed.right)}}function U(e,t){if(1&e){var n=s.Zb();s.Yb(0,"button",11),s.fc("click",(function(){return s.xc(n),s.jc().lockSideBar("left",!1)})),s.Ic(1,"Lock Panel"),s.Xb()}}function ee(e,t){if(1&e){var n=s.Zb();s.Yb(0,"button",11),s.fc("click",(function(){return s.xc(n),s.jc().lockSideBar("left",!0)})),s.Ic(1,"Float Panel"),s.Xb()}}function te(e,t){if(1&e&&s.Tb(0,"messages-channel",6),2&e){var n=t.$implicit,i=s.jc();s.pc("channel",n)("hidden",i.selectedChannel!=n)}}function ne(e,t){if(1&e){var n=s.Zb();s.Yb(0,"div",13),s.fc("click",(function(){return s.xc(n),s.jc().toggleSideBar("left")})),s.Tb(1,"nb-icon",14),s.Xb()}}function ie(e,t){if(1&e){var n=s.Zb();s.Yb(0,"div",15),s.fc("click",(function(){return s.xc(n),s.jc().toggleSideBar("right")})),s.Tb(1,"nb-icon",16),s.Xb()}}var ae,oe,re,ce,se=((oe=function(){function e(t,n,i,a){r(this,e),this.cd=t,this.ui=n,this.sidebarService=i,this.q=a,this.channelNameList=[],this.selectedChannel="NoChannelSelected",this.noChannelSelected="NoChannelSelected",this.sideBarFixed={right:!0,left:!0},this.sideBarVisible={right:!1,left:!0}}return o(e,[{key:"ngOnDestroy",value:function(){this.sideBarFixedSub.unsubscribe(),this.sideBarVisibleSub.unsubscribe(),this.channelFolderListSub.unsubscribe(),this.selectedChannelSub.unsubscribe()}},{key:"ngOnInit",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.q.isReady()&&this.q.os.isSignedIn()){e.next=5;break}return e.next=3,this.ui.delay(1e3);case 3:e.next=0;break;case 5:this.sideBarFixed=this.q.os.bee.config.getSideBarFixed(),this.sideBarVisible=this.q.os.bee.config.getSideBarVisible(),console.log("toggling:",this.sideBarVisible),this.sideBarVisible.left?this.sideBarVisible.left&&this.sidebarService.expand("left"):this.sidebarService.collapse("left"),this.sideBarVisible.right||this.sidebarService.collapse("right"),this.sideBarVisible.right&&this.sidebarService.expand("right"),this.sideBarFixedSub=this.q.os.bee.config.sideBarFixedSub.subscribe((function(e){t.sideBarFixed=t.q.os.bee.config.getSideBarFixed()})),this.sideBarVisibleSub=this.q.os.bee.config.sideBarVisibleSub.subscribe((function(e){console.log("getting",e),t.sideBarVisible=t.q.os.bee.config.getSideBarVisible(),t.sideBarVisible.left?t.sideBarVisible.left&&t.sidebarService.expand("left"):t.sidebarService.collapse("left"),t.sideBarVisible.right||t.sidebarService.collapse("right"),t.sideBarVisible.right&&t.sidebarService.expand("right")})),setTimeout((function(){t.sideBarFixed=t.q.os.bee.config.getSideBarFixed(),t.sideBarVisible=t.q.os.bee.config.getSideBarVisible(),console.log("toggling:",t.sideBarVisible),t.sideBarVisible.left?t.sideBarVisible.left&&t.sidebarService.expand("left"):t.sidebarService.collapse("left"),t.sideBarVisible.right||t.sidebarService.collapse("right"),t.sideBarVisible.right&&t.sidebarService.expand("right"),t.channelNameList=t.q.os.ocean.dolphin.getChannelNameList(),t.selectedChannel=t.q.os.channel.getSelected()}),100),this.channelFolderListSub=this.q.os.bee.config.channelFolderListSub.subscribe((function(e){t.channelNameList=t.q.os.ocean.dolphin.getChannelNameList()})),this.selectedChannelSub=this.q.os.channel.onSelect().subscribe((function(e){t.selectedChannel=e,console.log("Channel-Tab: Selected Channel: >>"+t.selectedChannel+"<<"),console.log("Channel-Tab: noChannelSelected: >>"+t.noChannelSelected+"<<"),t.cd.detectChanges()}));case 6:case"end":return e.stop()}}),e,this)})))}},{key:"lockSideBar",value:function(e,t){this.sideBarFixed[e]=t,this.q.os.bee.config.setSideBarFixed(this.sideBarFixed),this.q.os.bee.config.commitNow()}},{key:"toggleSideBar",value:function(e){this.sideBarVisible=this.q.os.bee.config.getSideBarVisible(),this.sideBarVisible[e]=1!=this.sideBarVisible[e],this.q.os.bee.config.setSideBarVisible(this.sideBarVisible),this.q.os.bee.config.commitNow()}}]),e}()).\u0275fac=function(e){return new(e||oe)(s.Sb(s.h),s.Sb(d.a),s.Sb(u.D),s.Sb(h.a))},oe.\u0275cmp=s.Mb({type:oe,selectors:[["messages-channel-tab"]],decls:13,vars:9,consts:[[1,"channelScreen"],["state","expanded","right","","tag","right","class","rightSideBar","collapsed","true",3,"fixed",4,"ngIf"],["state","expanded","left","","tag","left",1,"leftSideBar",3,"fixed"],["mat-stroked-button","","color","primary",1,"defaultSettingsButton","thinOutlineButton",2,"margin-right","24px","margin-left","0px",3,"click"],["mat-stroked-button","","color","primary","class","defaultSettingsButton thinOutlineButton",3,"click",4,"ngIf"],["class","channel",3,"channel","hidden",4,"ngFor","ngForOf"],[1,"channel",3,"channel","hidden"],["class","toggleSideBarRight toggleSideBarLeft","class","toggleSideBarLeft",3,"click",4,"ngIf"],["class","toggleSideBarRight","class","toggleSideBarRight",3,"click",4,"ngIf"],["state","expanded","right","","tag","right","collapsed","true",1,"rightSideBar",3,"fixed"],["mat-stroked-button","","color","primary","class","defaultSettingsButton thinOutlineButton","style","margin-left: 3px;margin-right: 21px;",3,"click",4,"ngIf"],["mat-stroked-button","","color","primary",1,"defaultSettingsButton","thinOutlineButton",3,"click"],["mat-stroked-button","","color","primary",1,"defaultSettingsButton","thinOutlineButton",2,"margin-left","3px","margin-right","21px",3,"click"],[1,"toggleSideBarLeft",3,"click"],["icon","list-outline"],[1,"toggleSideBarRight",3,"click"],["icon","more-vertical-outline"]],template:function(e,t){1&e&&(s.Yb(0,"nb-layout",0),s.Gc(1,J,6,3,"nb-sidebar",1),s.Yb(2,"nb-sidebar",2),s.Yb(3,"button",3),s.fc("click",(function(){return t.toggleSideBar("left")})),s.Ic(4,"Hide Panel"),s.Xb(),s.Gc(5,U,2,0,"button",4),s.Gc(6,ee,2,0,"button",4),s.Tb(7,"messages-channel-sidebar-left"),s.Xb(),s.Yb(8,"nb-layout-column"),s.Gc(9,te,1,2,"messages-channel",5),s.Tb(10,"messages-channel",6),s.Xb(),s.Xb(),s.Gc(11,ne,2,0,"div",7),s.Gc(12,ie,2,0,"div",8)),2&e&&(s.Fb(1),s.pc("ngIf","NoChannelSelected"!=t.selectedChannel),s.Fb(1),s.pc("fixed",t.sideBarFixed.left),s.Fb(3),s.pc("ngIf",t.sideBarFixed.left),s.Fb(1),s.pc("ngIf",!t.sideBarFixed.left),s.Fb(3),s.pc("ngForOf",t.channelNameList),s.Fb(1),s.pc("channel",t.noChannelSelected)("hidden",t.selectedChannel!=t.noChannelSelected),s.Fb(1),s.pc("ngIf",!t.sideBarVisible.left),s.Fb(1),s.pc("ngIf",!t.sideBarVisible.right&&"NoChannelSelected"!=t.selectedChannel))},directives:[u.u,p.m,u.B,b.a,v,u.t,p.l,m.a,Z,u.o],styles:[".toggleSideBarRight[_ngcontent-%COMP%]{right:7px}.toggleSideBarLeft[_ngcontent-%COMP%], .toggleSideBarRight[_ngcontent-%COMP%]{z-index:20;position:fixed;top:66px;cursor:pointer;color:#36f!important}.toggleSideBarLeft[_ngcontent-%COMP%]{left:7px}.defaultSettingsButton[_ngcontent-%COMP%]{padding-left:10px;padding-right:10px}.leftSideBar[_ngcontent-%COMP%]{z-index:52}.rightSideBar[_ngcontent-%COMP%]{z-index:51}"]}),oe),le=((ae=function e(){r(this,e)}).\u0275fac=function(e){return new(e||ae)},ae.\u0275cmp=s.Mb({type:ae,selectors:[["quest-messenger-root"]],decls:1,vars:0,template:function(e,t){1&e&&s.Tb(0,"messages-channel-tab")},directives:[se],styles:[".centerButtonWrapper[_ngcontent-%COMP%]{position:fixed;bottom:3vh;left:0;right:0}.centerButtonContainer[_ngcontent-%COMP%]{margin:auto}.statusBarWrapper[_ngcontent-%COMP%]{position:fixed;bottom:0;max-height:28px;height:28px;left:0;right:0;background-color:#2d2a2a;z-index:20;font-size:14px;color:grey;padding-left:10px;padding-right:10px;border-top:1px solid #000}.statusBarRouterIcon[_ngcontent-%COMP%]{top:4px;margin:0;position:relative;line-height:10px;font-size:21px}.statusBarRadioIcon[_ngcontent-%COMP%]{top:-5px;margin:0 0 0 5px;position:relative;line-height:9px;font-size:17px}.web-top-links[_ngcontent-%COMP%]{position:fixed;right:13px;cursor:pointer;z-index:20;top:14px}@media only screen and (max-width:500px){.web-top-links[_ngcontent-%COMP%]{display:none}}"]}),ae),de=[{path:"",component:le}],ue=((re=function e(){r(this,e)}).\u0275mod=s.Qb({type:re}),re.\u0275inj=s.Pb({factory:function(e){return new(e||re)},imports:[[c.g.forChild(de)],c.g]}),re),he=i("5RNC"),pe=i("Wp6s"),be=i("bSwM"),ge=i("STbY"),fe=i("8yBR"),ve=i("YUcS"),me=i("6NWb"),Ce=i("IyRd"),xe=i("f6nW"),ye=i("FvrZ"),ke=i("tk/3"),Fe=((ce=function e(){r(this,e)}).\u0275mod=s.Qb({type:ce}),ce.\u0275inj=s.Pb({factory:function(e){return new(e||ce)},imports:[p.c,k.f,c.g]}),ce);i("9gUW"),i("xUDc"),i("8SwR"),i("waa1"),i("bzWg"),i("cVQz"),i("K9Od");var we,Se,Ie=i("tayM"),Oe=i("zwFz"),Ne=i("d3J+"),Pe=i("fP41"),Me=((we=function(){function e(){r(this,e)}return o(e,null,[{key:"forRoot",value:function(t){return{ngModule:e,providers:[{provide:Ie.a,useValue:t||{}}]}}},{key:"forChild",value:function(t){return{ngModule:e,providers:[{provide:Ie.a,useValue:t||{}}]}}}]),e}()).\u0275mod=s.Qb({type:we}),we.\u0275inj=s.Pb({factory:function(e){return new(e||we)},imports:[[Fe,u.q,u.s,u.b,Oe.b,Ne.b,u.n,Pe.a]]}),we),Xe=i("NFeN"),je=i("tR1z"),Ye=((Se=function e(){r(this,e)}).\u0275mod=s.Qb({type:Se,bootstrap:[le]}),Se.\u0275inj=s.Pb({factory:function(e){return new(e||Se)},providers:[u.l],imports:[[u.C,xe.p,ye.d,u.x,L.b,ke.b,pe.a,D.b,b.b,be.a,ge.c,p.c,ue,me.a,u.J,u.v,Me,u.I,je.a,u.q,k.f,u.j,u.k.forRoot(),u.g,fe.d,C.c,b.b,be.a,y.b,R.d,Ce.b,he.a,ve.a,Xe.b,Pe.a],xe.p,R.d,D.b,fe.d,ge.c]}),Se)},"8SwR":function(t,n,i){"use strict";i.d(n,"a",(function(){return x}));var a=i("fXoL"),c=i("jhN1"),s=i("ofXK"),l=i("aceb"),d=i("3Pt+"),u=i("zwFz"),h=i("d3J+");function p(e,t){if(1&e){var n=a.Zb();a.Yb(0,"div"),a.Yb(1,"span",13),a.fc("click",(function(){a.xc(n);var e=a.jc().$implicit;return a.jc(2).removeFile(e)})),a.Ic(2,"\xd7"),a.Xb(),a.Xb()}if(2&e){var i=a.jc().$implicit;a.Dc("background-image",i.urlStyle)}}function b(e,t){1&e&&a.Tb(0,"nb-icon",14)}function g(e,t){if(1&e){var n=a.Zb();a.Wb(0),a.Gc(1,p,3,2,"div",11),a.Yb(2,"div"),a.Gc(3,b,1,0,"nb-icon",12),a.Yb(4,"span",13),a.fc("click",(function(){a.xc(n);var e=t.$implicit;return a.jc(2).removeFile(e)})),a.Ic(5,"\xd7"),a.Xb(),a.Xb(),a.Vb()}if(2&e){var i=t.$implicit;a.Fb(1),a.pc("ngIf",i.urlStyle),a.Fb(2),a.pc("ngIf",!i.urlStyle)}}function f(e,t){if(1&e&&(a.Yb(0,"div",9),a.Gc(1,g,6,2,"ng-container",10),a.Xb()),2&e){var n=a.jc();a.Fb(1),a.pc("ngForOf",n.droppedFiles)}}function v(e,t){if(1&e&&a.Tb(0,"nb-icon",15),2&e){var n=a.jc();a.pc("icon",n.buttonIcon)}}function m(e,t){if(1&e&&a.Ic(0),2&e){var n=a.jc();a.Jc(n.buttonTitle)}}function C(e,t){if(1&e){var n=a.Zb();a.Yb(0,"emoji-mart",16),a.fc("emojiClick",(function(e){return a.xc(n),a.jc().addEmoji(e)})),a.Xb()}}var x=function(){var t=function(){function t(e,n){r(this,t),this.cd=e,this.domSanitizer=n,this.newMessage="",this.emojiPickerActive=!1,this.status="",this.inputFocus=!1,this.inputHover=!1,this.droppedFiles=[],this.imgDropTypes=["image/png","image/jpeg","image/gif"],this.message="",this.buttonTitle="",this.buttonIcon="paper-plane-outline",this.showButton=!0,this.dropFiles=!1,this.send=new a.p,this.fileOver=!1}return o(t,[{key:"addEmoji",value:function(e){this.newMessage+=" "+e.emoji.colons+" ",this.emojiPickerActive=!1}},{key:"openEmojiPicker",value:function(){this.emojiPickerActive=!0}},{key:"onDrop",value:function(t){var n=this;if(this.dropFiles&&(t.preventDefault(),t.stopPropagation(),this.fileOver=!1,t.dataTransfer&&t.dataTransfer.files)){var i,a=e(t.dataTransfer.files);try{var o=function(){var e=i.value,t=e;if(n.imgDropTypes.includes(e.type)){var a=new FileReader;a.onload=function(e){t.src=e.target.result,t.urlStyle=n.domSanitizer.bypassSecurityTrustStyle("url(".concat(t.src,")")),n.cd.detectChanges()},a.readAsDataURL(e)}n.droppedFiles.push(t)};for(a.s();!(i=a.n()).done;)o()}catch(r){a.e(r)}finally{a.f()}}}},{key:"removeFile",value:function(e){var t=this.droppedFiles.indexOf(e);t>=0&&this.droppedFiles.splice(t,1)}},{key:"onDragOver",value:function(){this.dropFiles&&(this.fileOver=!0)}},{key:"onDragLeave",value:function(){this.dropFiles&&(this.fileOver=!1)}},{key:"sendMessage",value:function(){(this.droppedFiles.length||String(this.newMessage).trim().length)&&(this.send.emit({message:this.newMessage,files:this.droppedFiles}),this.message="",this.newMessage="",this.droppedFiles=[])}},{key:"setStatus",value:function(e){this.status!==e&&(this.status=e,this.cd.detectChanges())}},{key:"getInputStatus",value:function(){return this.fileOver?this.status||"primary":this.inputFocus||this.inputHover?this.status:""}}]),t}();return t.\u0275fac=function(e){return new(e||t)(a.Sb(a.h),a.Sb(c.b))},t.\u0275cmp=a.Mb({type:t,selectors:[["nb-chat-form"]],hostVars:2,hostBindings:function(e,t){1&e&&a.fc("drop",(function(e){return t.onDrop(e)}))("dragover",(function(){return t.onDragOver()}))("dragleave",(function(){return t.onDragLeave()})),2&e&&a.Kb("file-over",t.fileOver)},inputs:{message:"message",buttonTitle:"buttonTitle",buttonIcon:"buttonIcon",showButton:"showButton",dropFiles:"dropFiles"},outputs:{send:"send"},decls:10,vars:11,consts:[["class","dropped-files",4,"ngIf"],[1,"message-row"],[2,"width","100%"],["nbInput","","fullWidth","","type","text",3,"ngModel","status","placeholder","ngModelChange","focus","blur","mouseenter","mouseleave","keyup.enter"],["nbSuffix","","nbButton","","ghost","",3,"status","click"],["pack","nebular-essentials",3,"icon",4,"ngIf","ngIfElse"],["title",""],["title","Pick your emoji\u2026","emoji","blush","class","emojiPicker","darkMode","true","style","position: absolute;  bottom: 30px;  right: 80px;",3,"emojiClick",4,"ngIf"],["emoji","grinning","set","apple","size","26",1,"emojiPickerTrigger",3,"click"],[1,"dropped-files"],[4,"ngFor","ngForOf"],[3,"background-image",4,"ngIf"],["icon","file-text-outline","pack","nebular-essentials",4,"ngIf"],[1,"remove",3,"click"],["icon","file-text-outline","pack","nebular-essentials"],["pack","nebular-essentials",3,"icon"],["title","Pick your emoji\u2026","emoji","blush","darkMode","true",1,"emojiPicker",2,"position","absolute","bottom","30px","right","80px",3,"emojiClick"]],template:function(e,t){if(1&e&&(a.Gc(0,f,2,1,"div",0),a.Yb(1,"div",1),a.Yb(2,"nb-form-field",2),a.Yb(3,"input",3),a.fc("ngModelChange",(function(e){return t.newMessage=e}))("focus",(function(){return t.inputFocus=!0}))("blur",(function(){return t.inputFocus=!1}))("mouseenter",(function(){return t.inputHover=!0}))("mouseleave",(function(){return t.inputHover=!1}))("ngModelChange",(function(e){return t.message=e}))("keyup.enter",(function(){return t.sendMessage()})),a.Xb(),a.Yb(4,"button",4),a.fc("click",(function(){return t.sendMessage()})),a.Gc(5,v,1,1,"nb-icon",5),a.Gc(6,m,1,1,"ng-template",null,6,a.Hc),a.Xb(),a.Xb(),a.Xb(),a.Gc(8,C,1,0,"emoji-mart",7),a.Yb(9,"ngx-emoji",8),a.fc("click",(function(){return t.openEmojiPicker()})),a.Xb()),2&e){var n=a.vc(7);a.pc("ngIf",null==t.droppedFiles?null:t.droppedFiles.length),a.Fb(3),a.Kb("with-button",t.showButton),a.qc("placeholder",t.fileOver?"Drop file to send":"Type a message"),a.pc("ngModel",t.newMessage)("status",t.getInputStatus())("ngModel",t.message),a.Fb(1),a.pc("status",t.status||"primary"),a.Fb(1),a.pc("ngIf",!t.buttonTitle)("ngIfElse",n),a.Fb(3),a.pc("ngIf",t.emojiPickerActive)}},directives:[s.m,l.m,l.r,d.b,d.j,d.m,l.a,l.E,u.a,s.l,l.o,h.a],styles:[""],changeDetection:0}),t}()},"9gUW":function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n("8SwR"),a=n("xUDc"),c=n("fXoL"),s=n("ofXK"),l=["scrollable"];function d(e,t){1&e&&(c.Yb(0,"p",6),c.Ic(1,"No messages yet."),c.Xb())}var u=[[["nb-chat-message"]],[["nb-chat-form"]]],h=["nb-chat-message","nb-chat-form"],p=function(){var e=function(){function e(){r(this,e),this._scrollBottom=!0}return o(e,[{key:"ngOnChanges",value:function(e){"status"in e&&this.updateFormStatus()}},{key:"ngAfterContentInit",value:function(){this.updateFormStatus()}},{key:"ngAfterViewInit",value:function(){var e=this;this.messages.changes.subscribe((function(t){e.messages=t,e.updateView()})),window["quest-network-ui-globals"]={},window["quest-network-ui-globals"]["messages-chat-scrollable"]=this.scrollable.nativeElement,this.updateView()}},{key:"updateView",value:function(){this.scrollBottom&&this.scrollListBottom()}},{key:"scrollListBottom",value:function(){window["quest-network-ui-globals"]={},window["quest-network-ui-globals"]["messages-chat-scrollable"]=this.scrollable.nativeElement,this.scrollable.nativeElement.scrollTop>this.scrollable.nativeElement.scrollHeight-$(this.scrollable.nativeElement).height()-210&&(this.scrollable.nativeElement.scrollTop=this.scrollable.nativeElement.scrollHeight)}},{key:"updateFormStatus",value:function(){this.chatForm&&this.chatForm.setStatus(this.status)}},{key:"scrollBottom",get:function(){return this._scrollBottom},set:function(e){var t;this._scrollBottom="string"==typeof(t=e)?"true"===(t=t.toLowerCase().trim())||""===t:!!t}},{key:"tiny",get:function(){return"tiny"===this.size}},{key:"small",get:function(){return"small"===this.size}},{key:"medium",get:function(){return"medium"===this.size}},{key:"large",get:function(){return"large"===this.size}},{key:"giant",get:function(){return"giant"===this.size}},{key:"primary",get:function(){return"primary"===this.status}},{key:"success",get:function(){return"success"===this.status}},{key:"info",get:function(){return"info"===this.status}},{key:"warning",get:function(){return"warning"===this.status}},{key:"danger",get:function(){return"danger"===this.status}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Mb({type:e,selectors:[["nb-chat"]],contentQueries:function(e,t,n){var o;1&e&&(c.Lb(n,i.a,!0),c.Lb(n,a.a,!1)),2&e&&(c.uc(o=c.gc())&&(t.chatForm=o.first),c.uc(o=c.gc())&&(t.messages=o))},viewQuery:function(e,t){var n;1&e&&c.Mc(l,!0),2&e&&c.uc(n=c.gc())&&(t.scrollable=n.first)},hostVars:20,hostBindings:function(e,t){2&e&&c.Kb("size-tiny",t.tiny)("size-small",t.small)("size-medium",t.medium)("size-large",t.large)("size-giant",t.giant)("status-primary",t.primary)("status-success",t.success)("status-info",t.info)("status-warning",t.warning)("status-danger",t.danger)},inputs:{title:"title",size:"size",status:"status",scrollBottom:"scrollBottom"},features:[c.Db],ngContentSelectors:h,decls:9,vars:2,consts:[[1,"header"],["id","scrollableChatContainer",1,"scrollable"],["scrollable",""],[1,"messages"],["class","no-messages",4,"ngIf"],[1,"form"],[1,"no-messages"]],template:function(e,t){1&e&&(c.oc(u),c.Yb(0,"div",0),c.Ic(1),c.Xb(),c.Yb(2,"div",1,2),c.Yb(4,"div",3),c.nc(5),c.Gc(6,d,2,0,"p",4),c.Xb(),c.Xb(),c.Yb(7,"div",5),c.nc(8,1),c.Xb()),2&e&&(c.Fb(1),c.Jc(t.title),c.Fb(5),c.pc("ngIf",!(null!=t.messages&&t.messages.length)))},directives:[s.m],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;position:relative;height:100%}.messages[_ngcontent-%COMP%]{padding-bottom:0!important;margin-bottom:0}"]}),e}()},Cjz3:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return k}));var i=n("n2fA"),a=n("dT8p"),c=n("fXoL"),s=n("jhN1"),l=n("Witw"),d=n("gvxT"),u=n("XiUz"),h=n("3Pt+"),p=n("kmnG"),b=n("qFsG"),g=n("bTqV"),f=n("9gUW"),v=n("ofXK"),m=n("8SwR"),C=n("xUDc"),x=["newMessage"];function y(e,t){if(1&e&&c.Tb(0,"nb-chat-message",17),2&e){var n=t.$implicit;c.pc("type",n.type)("message",n.message)("reply",n.reply)("sender",n.participant)("date",n.timestamp)("files",n.files)("quote",n.quote)("latitude",n.latitude)("longitude",n.longitude)("avatar",n.participant.avatar)}}var k=function(){var t=function(){function t(e,n,i,o){r(this,t),this._sanitizer=e,this.aChD=n,this.ui=i,this.q=o,this.DEVMODE=a.dev,this.noChannelSelected="NoChannelSelected",this.channelDisplayName="NoChannelSelected",this.showChallengeScreen=!1,this.showJoinScreen=!1,this.showInviteScreen=!1,this.messages=[],this.handledMessages=[]}return o(t,[{key:"ngOnDestroy",value:function(){void 0!==this.channelSub&&this.channelSub.unsubscribe()}},{key:"scrollBottom",value:function(){try{this.scrollable={},this.scrollable.nativeElement=window["quest-network-ui-globals"]["messages-chat-scrollable"],null!=this.scrollable.nativeElement&&this.scrollable.nativeElement.scrollTop>this.scrollable.nativeElement.scrollHeight-$(this.scrollable.nativeElement).height()-210&&(this.scrollable.nativeElement.scrollTop=this.scrollable.nativeElement.scrollHeight)}catch(e){console.log(e)}}},{key:"ngOnInit",value:function(){return Object(i.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Channel: Initializing..."),console.log("Channel: Bootstrapping Channel..."),e.t0="NoChannelSelected"!=this.channel,!e.t0){e.next=7;break}return setTimeout((function(){t.scrollBottom()}),2500),e.next=7,this.attemptJoinChannel(this.channel);case 7:return e.next=9,this.getChannelDisplayName(this.channel);case 9:this.channelDisplayName=e.sent;case 10:case"end":return e.stop()}}),e,this)})))}},{key:"getChannelDisplayName",value:function(e){return Object(i.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.indexOf("qprivatedch")>-1)){t.next=6;break}return t.next=3,this.q.os.social.getAliasFromDirectChannel2(e);case 3:t.t0=t.sent,t.next=7;break;case 6:t.t0=e;case 7:return t.abrupt("return",t.t0);case 8:case"end":return t.stop()}}),t,this)})))}},{key:"goToCaptcha",value:function(){this.showChallengeScreen=!0,this.showJoinScreen=!1,this.showInviteScreen=!1}},{key:"goToInviteScreen",value:function(){this.showChallengeScreen=!1,this.showJoinScreen=!1,this.showInviteScreen=!0}},{key:"goToJoin",value:function(){this.showChallengeScreen=!1,this.showJoinScreen=!0,this.showInviteScreen=!1}},{key:"challengeFail",value:function(){return this.showChallengeScreen=!0,this.ui.updateProcessingStatus(!1),this.ui.setElectronSize("0-keyimport"),this.ui.showSnack("Prove that you are smart","Please",{duration:4e3}),!1}},{key:"completedChallenge",value:function(e){var t=this;setTimeout((function(){t.ui.updateProcessingStatus(!1)}),3e4),this.ui.updateProcessingStatus(!0),this.q.os.ocean.dolphin.completedChallenge(this.channel,e)}},{key:"capitalize",value:function(e){return"string"!=typeof e?"":e.charAt(0).toUpperCase()+e.slice(1)}},{key:"handleNewMessage",value:function(t){return Object(i.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,a,o,r,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("CHALLENGE"!=t.type){n.next=5;break}console.log("Received Challenge"),void 0!==t.captchaImageBuffer&&(i=e.from(t.captchaImageBuffer.data).toString("base64"),this.captchaImageResource=this._sanitizer.bypassSecurityTrustUrl("data:image/png;base64,"+i)),this.showJoinScreen=!0,this.ui.updateProcessingStatus(!1),this.aChD.detectChanges(),n.next=16;break;case 5:if("ownerSayHi"!=t.type){n.next=9;break}this.ui.updateProcessingStatus(!1),this.showChallengeScreen=!1,this.showJoinScreen=!1,this.showInviteScreen=!1,this.aChD.detectChanges(),n.next=16;break;case 9:if("CHANNEL_MESSAGE"!=t.type){n.next=16;break}return t.participant={},t.reply=!!t.self,n.next=13,this.getSocialProfileForChannelPubKey(t.channel,t.channelPubKey);case 13:if(a=n.sent,t.participant.name=void 0!==a.nick?a.nick:a.alias,void 0!==a.key?(t.participant.social=a.key.pubKey,t.participant.isFavorite=this.q.os.social.profile.isFavorite(a.key.pubKey),t.participant.isRequestedFavorite=this.q.os.social.profile.isRequestedFavorite(a.key.pubKey)):(t.participant.social="unknown",t.participant.isFavorite=!1,t.participant.isRequestedFavorite=!1),t.participant.avatar="./assets/defaultAvatar.png",console.log(this.q.os.ui.getHandledMessages()),this.messages.length>0&&t.channelPubKey==this.messages[this.messages.length-1].channelPubKey&&!this.q.os.utilities.inArray(this.q.os.ui.getHandledMessages(),t.id)){o="\n";try{r=this.messages[this.messages.length-1].message,(c=String(r).split("\n")).length>1&&("!"==(r=String(c[c.length-1])).trim().charAt(r.length-1)||"?"==r.trim().charAt(r.length-1)||","==r.trim().charAt(r.length-1)||"."==r.trim().charAt(r.length-1)||";"==r.trim().charAt(r.length-1)?o=" ":":"!=r.trim().charAt(r.length-1)&&"-"!=r.trim().charAt(r.length-1)&&":"!=r.trim().charAt(r.length-1)&&(o="\n"))}catch(s){console.log(s)}this.q.os.ui.addHandledMessage(t.id),this.messages[this.messages.length-1].message+=o+this.capitalize(String(t.message).trim())}else this.q.os.utilities.inArray(this.q.os.ui.getHandledMessages(),t.id)||(t.message=this.capitalize(String(t.message).trim()),this.messages.push(t));this.aChD.detectChanges();case 16:return n.abrupt("return",!0);case 17:case"end":return n.stop()}}),n,this)})))}},{key:"getSocialProfileForChannelPubKey",value:function(e,t){return Object(i.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,a,o,r,c,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!((a=this.q.os.channel.getParticipantFolders(e)).length>0)){n.next=37;break}o=0;case 3:if(!(o<a.length)){n.next=37;break}r=0;case 5:if(!(r<a[o].participants.length)){n.next=34;break}if(a[o].participants[r].pubKey!=t||void 0===a[o].participants[r].nick||""==a[o].participants[r].nick){n.next=18;break}return c=void 0,n.prev=8,n.next=11,this.q.os.social.profile.getByChannelPubKey(a[o].participants[r].pubKey);case 11:c=n.sent,n.next=17;break;case 14:n.prev=14,n.t0=n.catch(8),console.log(n.t0);case 17:return n.abrupt("return",void 0!==c&&void 0!==c.alias?(c.nick=a[o].participants[r].nick,c):{nick:a[o].participants[r].nick});case 18:if(a[o].participants[r].pubKey!=t){n.next=31;break}return s=void 0,n.prev=20,n.next=23,this.q.os.social.profile.getByChannelPubKey(a[o].participants[r].pubKey);case 23:s=n.sent,n.next=29;break;case 26:n.prev=26,n.t1=n.catch(20),console.log(n.t1);case 29:if(void 0===s||void 0===s.alias){n.next=31;break}return n.abrupt("return",s);case 31:r++,n.next=5;break;case 34:o++,n.next=3;break;case 37:return n.prev=37,n.next=40,this.q.os.social.profile.getByChannelPubKey(t);case 40:i=n.sent,n.next=46;break;case 43:n.prev=43,n.t2=n.catch(37),console.log(n.t2);case 46:return n.abrupt("return",void 0!==i&&void 0!==i.alias?i:{alias:"Anonymous"});case 47:case"end":return n.stop()}}),n,this,[[8,14],[20,26],[37,43]])})))}},{key:"attemptJoinChannel",value:function(e){return Object(i.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,a,o,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.q.os.sendBootMessage("Shaking Hands..."),setTimeout((function(){r.ui.updateProcessingStatus(!1)}),2e4),console.log("attempting to join: ",e),t.prev=1,t.t0=this.q.os.ocean.dolphin.isSubscribed(this.channel),t.t0){t.next=6;break}return t.next=6,this.q.os.ocean.dolphin.joinChannel(e);case 6:n=this.q.os.ocean.dolphin.getChannelHistory(this.channel),this.DEVMODE&&console.log("got history: ",n),a=0;case 9:if(!(a<n.length)){t.next=15;break}return t.next=12,this.handleNewMessage(n[a]);case 12:a++,t.next=9;break;case 15:this.channelSub=this.q.os.ocean.dolphin.listen(e).subscribe((function(e){return Object(i.a)(r,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.handleNewMessage(e);case 2:case"end":return t.stop()}}),t,this)})))})),o=this.q.os.ocean.dolphin.isOwner(e,this.q.os.ocean.dolphin.getChannelKeyChain(e).channelPubKey),console.log("isOwner:",o),o&&(this.showChallengeScreen=!1,this.showJoinScreen=!1,this.showInviteScreen=!1,this.ui.updateProcessingStatus(!1)),t.next=37;break;case 20:if(t.prev=20,t.t1=t.catch(1),"reCaptcha"!=t.t1){t.next=26;break}t.t2=this.challengeFail(),t.next=36;break;case 26:if("key invalid"!=t.t1){t.next=30;break}t.t3=(this.ui.showSnack("Invalid Key!","Start Over",{duration:8e3}),this.ui.delay(2e3),!1),t.next=35;break;case 30:return this.ui.showSnack("Swarm Error =(","Start Over",{duration:8e3}),console.log(t.t1),t.next=34,this.ui.delay(5e3);case 34:t.t3=!1;case 35:t.t2=t.t3;case 36:return t.abrupt("return",t.t2);case 37:case"end":return t.stop()}}),t,this,[[1,20]])})))}},{key:"publishChannelMessage",value:function(e){return Object(i.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.q.os.channel.publish(this.channel,e.message),this.newMessage.nativeElement.value="";case 1:case"end":return t.stop()}}),t,this)})))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(c.Sb(s.b),c.Sb(c.h),c.Sb(l.a),c.Sb(d.a))},t.\u0275cmp=c.Mb({type:t,selectors:[["messages-channel"]],viewQuery:function(e,t){var n;1&e&&c.Mc(x,!0),2&e&&c.uc(n=c.gc())&&(t.newMessage=n.first)},inputs:{channel:"channel"},decls:41,vars:10,consts:[[1,"captchaScreen",3,"hidden"],["fxLayout","column","fxLayoutAlign","space-around center"],[1,"wrapper"],[1,"frameThumbnail",2,"width","80%","margin","10%","margin-top","0",3,"src"],[1,"example-form"],[1,"example-full-width"],["matInput","","placeholder","Captcha Text","value","","name","captchaCode",3,"ngModel","ngModelChange"],["mat-stroked-button","","color","primary",1,"thickOutlineButton","marginRight20",3,"click"],["mat-stroked-button","","color","primary",1,"thickOutlineButton",3,"click"],[1,"inviteScreen",3,"hidden"],["color","primary",1,"example-full-width"],["matInput","","placeholder","Invite Code","value","","name","inviteToken",3,"ngModel","ngModelChange"],[1,"joinScreen",3,"hidden"],[1,"chatScreen",3,"hidden"],[3,"title"],[3,"type","message","reply","sender","date","files","quote","latitude","longitude","avatar",4,"ngFor","ngForOf"],[3,"dropFiles","send"],[3,"type","message","reply","sender","date","files","quote","latitude","longitude","avatar"]],template:function(e,t){1&e&&(c.Yb(0,"div",0),c.Yb(1,"div",1),c.Yb(2,"div",2),c.Tb(3,"img",3),c.Yb(4,"form",4),c.Yb(5,"mat-form-field",5),c.Yb(6,"mat-label"),c.Ic(7,"Captcha Text"),c.Xb(),c.Yb(8,"input",6),c.fc("ngModelChange",(function(e){return t.captchaCode=e})),c.Xb(),c.Xb(),c.Xb(),c.Yb(9,"button",7),c.fc("click",(function(){return t.goToJoin()})),c.Ic(10,"Back"),c.Xb(),c.Yb(11,"button",8),c.fc("click",(function(){return t.completedChallenge(t.captchaCode)})),c.Ic(12,"I Aced That IQ Test"),c.Xb(),c.Xb(),c.Xb(),c.Xb(),c.Yb(13,"div",9),c.Yb(14,"div",1),c.Yb(15,"div",2),c.Ic(16," Enter Invite code: "),c.Yb(17,"form",4),c.Yb(18,"mat-form-field",10),c.Yb(19,"mat-label"),c.Ic(20,"Invite Code"),c.Xb(),c.Yb(21,"input",11),c.fc("ngModelChange",(function(e){return t.inviteToken=e})),c.Xb(),c.Xb(),c.Xb(),c.Tb(22,"br"),c.Tb(23,"br"),c.Yb(24,"button",7),c.fc("click",(function(){return t.goToJoin()})),c.Ic(25,"Back"),c.Xb(),c.Yb(26,"button",8),c.fc("click",(function(){return t.completedChallenge(t.inviteToken)})),c.Ic(27,"Let me in!"),c.Xb(),c.Xb(),c.Xb(),c.Xb(),c.Yb(28,"div",12),c.Yb(29,"div",1),c.Yb(30,"div",2),c.Yb(31,"button",8),c.fc("click",(function(){return t.goToInviteScreen()})),c.Ic(32,"I have an invite code!"),c.Xb(),c.Tb(33,"br"),c.Tb(34,"br"),c.Yb(35,"button",8),c.fc("click",(function(){return t.goToCaptcha()})),c.Ic(36,"Give me the challenge!"),c.Xb(),c.Xb(),c.Xb(),c.Xb(),c.Yb(37,"div",13),c.Yb(38,"nb-chat",14),c.Gc(39,y,1,10,"nb-chat-message",15),c.Yb(40,"nb-chat-form",16),c.fc("send",(function(e){return t.publishChannelMessage(e)})),c.Xb(),c.Xb(),c.Xb()),2&e&&(c.pc("hidden",!t.showChallengeScreen),c.Fb(3),c.pc("src",t.captchaImageResource,c.zc),c.Fb(5),c.pc("ngModel",t.captchaCode),c.Fb(5),c.pc("hidden",!t.showInviteScreen),c.Fb(8),c.pc("ngModel",t.inviteToken),c.Fb(7),c.pc("hidden",!t.showJoinScreen),c.Fb(9),c.pc("hidden",t.showJoinScreen||t.showInviteScreen||t.showChallengeScreen||t.channel==t.noChannelSelected),c.Fb(1),c.qc("title",t.channelDisplayName),c.Fb(1),c.pc("ngForOf",t.messages),c.Fb(1),c.pc("dropFiles",!0))},directives:[u.b,u.a,h.p,h.k,h.l,p.b,p.f,b.a,h.b,h.j,h.m,g.a,f.a,v.l,m.a,C.a],styles:[".browse-files-button[_ngcontent-%COMP%]{border-radius:3px;padding:5px;color:purple}.importButton[_ngcontent-%COMP%]{color:purple!important}.captchaScreen[_ngcontent-%COMP%], .inviteScreen[_ngcontent-%COMP%], .joinScreen[_ngcontent-%COMP%]{background-color:#222b45;padding:20px;text-align:center}.captchaScreen[_ngcontent-%COMP%], .captchaScreen[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .chatScreen[_ngcontent-%COMP%], .inviteScreen[_ngcontent-%COMP%], .inviteScreen[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .joinScreen[_ngcontent-%COMP%], .joinScreen[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{height:100%}"]}),t}()}).call(this,n("tjlA").Buffer)},K9Od:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("fXoL"),a=n("tayM"),c=n("bzWg"),s=function(e){return[e]},l=function(){var e=function(){function e(t){r(this,e),this.mapKey=t.messageGoogleMapKey}return o(e,[{key:"file",get:function(){return{url:"https://maps.googleapis.com/maps/api/staticmap?center=".concat(this.latitude,",").concat(this.longitude,"&zoom=12&size=400x400&key=").concat(this.mapKey),type:"image/png",icon:"location"}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i.Sb(a.a))},e.\u0275cmp=i.Mb({type:e,selectors:[["nb-chat-message-map"]],inputs:{message:"message",sender:"sender",date:"date",latitude:"latitude",longitude:"longitude"},decls:1,vars:6,consts:[[3,"files","message","sender","date"]],template:function(e,t){1&e&&i.Tb(0,"nb-chat-message-file",0),2&e&&i.pc("files",i.sc(4,s,t.file))("message",t.message)("sender",t.sender)("date",t.date)},directives:[c.a],encapsulation:2,changeDetection:0}),e}()},bzWg:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var i=n("fXoL"),a=n("jhN1"),c=n("waa1"),s=n("ofXK"),l=n("aceb");function d(e,t){if(1&e&&i.Tb(0,"nb-icon",7),2&e){var n=i.jc().$implicit;i.pc("icon",n.icon)}}function u(e,t){if(1&e&&i.Tb(0,"div"),2&e){var n=i.jc().$implicit;i.Dc("background-image",n.urlStyle)}}function h(e,t){if(1&e&&(i.Yb(0,"a",4),i.Gc(1,d,1,1,"nb-icon",5),i.Gc(2,u,1,2,"div",6),i.Xb()),2&e){var n=t.$implicit;i.pc("href",n.url,i.zc),i.Fb(1),i.pc("ngIf",!n.urlStyle&&n.icon),i.Fb(1),i.pc("ngIf",n.urlStyle)}}function p(e,t){if(1&e&&(i.Wb(0),i.Yb(1,"div",2),i.Gc(2,h,3,3,"a",3),i.Xb(),i.Vb()),2&e){var n=i.jc();i.Fb(2),i.pc("ngForOf",n.readyFiles)}}function b(e,t){if(1&e&&i.Tb(0,"nb-icon",7),2&e){var n=i.jc(2);i.pc("icon",n.readyFiles[0].icon)}}function g(e,t){if(1&e&&i.Tb(0,"div"),2&e){var n=i.jc(2);i.Dc("background-image",n.readyFiles[0].urlStyle)}}function f(e,t){if(1&e&&(i.Wb(0),i.Yb(1,"a",4),i.Gc(2,b,1,1,"nb-icon",5),i.Gc(3,g,1,2,"div",6),i.Xb(),i.Vb()),2&e){var n=i.jc();i.Fb(1),i.pc("href",n.readyFiles[0].url,i.zc),i.Fb(1),i.pc("ngIf",!n.readyFiles[0].urlStyle&&n.readyFiles[0].icon),i.Fb(1),i.pc("ngIf",n.readyFiles[0].urlStyle)}}var v=function(){var e=function(){function e(t,n){r(this,e),this.cd=t,this.domSanitizer=n}return o(e,[{key:"isImage",value:function(e){return["image/png","image/jpeg","image/gif"].includes(e.type)}},{key:"files",set:function(e){var t=this;this.readyFiles=(e||[]).map((function(e){var n=t.isImage(e);return Object.assign(Object.assign({},e),{urlStyle:n&&t.domSanitizer.bypassSecurityTrustStyle("url(".concat(e.url,")")),isImage:n})})),this.cd.detectChanges()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i.Sb(i.h),i.Sb(a.b))},e.\u0275cmp=i.Mb({type:e,selectors:[["nb-chat-message-file"]],inputs:{message:"message",sender:"sender",date:"date",files:"files"},decls:4,vars:6,consts:[[3,"sender","date","message"],[4,"ngIf"],[1,"message-content-group"],["target","_blank",3,"href",4,"ngFor","ngForOf"],["target","_blank",3,"href"],[3,"icon",4,"ngIf"],[3,"background-image",4,"ngIf"],[3,"icon"]],template:function(e,t){1&e&&(i.Yb(0,"nb-chat-message-text",0),i.Ic(1),i.Xb(),i.Gc(2,p,3,1,"ng-container",1),i.Gc(3,f,4,3,"ng-container",1)),2&e&&(i.pc("sender",t.sender)("date",t.date)("message",t.message),i.Fb(1),i.Kc(" ",t.message," "),i.Fb(1),i.pc("ngIf",(null==t.readyFiles?null:t.readyFiles.length)>1),i.Fb(1),i.pc("ngIf",1===(null==t.readyFiles?null:t.readyFiles.length)))},directives:[c.a,s.m,s.l,l.o],encapsulation:2,changeDetection:0}),e}()},cVQz:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n("fXoL"),a=n("ofXK"),o=n("waa1");function c(e,t){if(1&e&&(i.Yb(0,"p",3),i.Ic(1),i.Yb(2,"time"),i.Ic(3),i.kc(4,"date"),i.Xb(),i.Xb()),2&e){var n=i.jc();i.Fb(1),i.Kc("",n.sender," "),i.Fb(2),i.Jc(i.mc(4,2,n.date,"shortTime"))}}var s=function(){var e=function e(){r(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Mb({type:e,selectors:[["nb-chat-message-quote"]],inputs:{message:"message",sender:"sender",date:"date",quote:"quote"},decls:5,vars:4,consts:[["class","sender",4,"ngIf"],[1,"quote"],[3,"message"],[1,"sender"]],template:function(e,t){1&e&&(i.Gc(0,c,5,5,"p",0),i.Yb(1,"p",1),i.Ic(2),i.Xb(),i.Yb(3,"nb-chat-message-text",2),i.Ic(4),i.Xb()),2&e&&(i.pc("ngIf",t.sender||t.date),i.Fb(2),i.Kc(" ",t.quote," "),i.Fb(1),i.pc("message",t.message),i.Fb(1),i.Kc(" ",t.message," "))},directives:[a.m,o.a],pipes:[a.e],encapsulation:2,changeDetection:0}),e}()},dT8p:function(e){e.exports=JSON.parse('{"dev":false}')},rk8u:function(e,n,i){"use strict";(function(e){i.d(n,"a",(function(){return Z}));var a=i("n2fA"),c=i("FQBZ"),s=i("dT8p"),l=i("2Vo4"),d=i("0EQZ"),u=i("FvrZ"),h=i("8yBR"),p=i("STbY"),b=i("fXoL"),g=i("Witw"),f=i("aceb"),v=i("gvxT"),m=i("kmnG"),C=i("qFsG"),x=i("d3UM"),y=i("ofXK"),k=i("3Pt+"),F=i("bTqV"),w=i("FKr1"),S=i("IyRd"),I=i("znSr"),O=i("NFeN"),N=["emptyItem"],P=["qrPop"],M=["createPop"],X=["folder"],j=["import"];function Y(e,t){if(1&e&&(b.Yb(0,"mat-option",23),b.Ic(1),b.Xb()),2&e){var n=t.$implicit;b.pc("value",n.id),b.Fb(1),b.Kc(" ",n.data.name," ")}}function q(e,t){if(1&e){var n=b.Zb();b.Yb(0,"nb-card"),b.Yb(1,"nb-card-header"),b.Ic(2,"Create Channel"),b.Xb(),b.Yb(3,"nb-card-body",15),b.Yb(4,"div",16),b.Ic(5," Folder: "),b.Yb(6,"mat-select",17),b.fc("valueChange",(function(e){return b.xc(n),b.jc().newChannelFolder=e}))("selectionChange",(function(e){return b.xc(n),b.jc().newChannelFolderChanged(e.value)})),b.Gc(7,Y,2,2,"mat-option",18),b.Xb(),b.Xb(),b.Yb(8,"div",19),b.Yb(9,"input",20),b.fc("ngModelChange",(function(e){return b.xc(n),b.jc().newChannelName=e}))("keydown",(function(e){b.xc(n);var t=b.jc();return t.createNewChannelKeyDown(t.newChannelName,e)})),b.Xb(),b.Xb(),b.Xb(),b.Yb(10,"nb-card-footer"),b.Yb(11,"button",21),b.fc("click",(function(){b.xc(n);var e=b.jc();return e.createNewChannel(e.newChannelName)})),b.Ic(12,"Create"),b.Xb(),b.Yb(13,"button",22),b.fc("click",(function(){return b.xc(n),b.jc().closePopup()})),b.Ic(14,"Cancel"),b.Xb(),b.Xb(),b.Xb()}if(2&e){var i=b.jc();b.Fb(6),b.pc("value",i.newChannelFolder),b.Fb(1),b.pc("ngForOf",i.channelFolderListArray),b.Fb(2),b.pc("ngModel",i.newChannelName)}}function T(e,t){if(1&e){var n=b.Zb();b.Yb(0,"nb-card"),b.Yb(1,"nb-card-header"),b.Ic(2,"Scan QR"),b.Xb(),b.Yb(3,"nb-card-body",15),b.Yb(4,"div",24),b.Yb(5,"zxing-scanner",25),b.fc("deviceChange",(function(e){return b.xc(n),b.jc().currentDevice=e}))("scanSuccess",(function(e){return b.xc(n),b.jc().qrSuccessHandler(e)}))("permissionResponse",(function(e){return b.xc(n),b.jc().onHasPermission(e)}))("camerasFound",(function(e){return b.xc(n),b.jc().onCamerasFound(e)}))("torchCompatible",(function(e){return b.xc(n),b.jc().onTorchCompatible(e)})),b.Xb(),b.Xb(),b.Xb(),b.Yb(6,"nb-card-footer"),b.Yb(7,"button",22),b.fc("click",(function(){return b.xc(n),b.jc().closeQR()})),b.Ic(8,"Cancel"),b.Xb(),b.Xb(),b.Xb()}if(2&e){var i=b.jc();b.Fb(5),b.pc("torch",i.torchEnabled)("device",i.currentDevice)("formats",i.formatsEnabled)("tryHarder",i.tryHarder)}}function E(e,t){if(1&e&&(b.Yb(0,"mat-option",23),b.Ic(1),b.Xb()),2&e){var n=t.$implicit;b.pc("value",n.id),b.Fb(1),b.Kc(" ",n.data.name," ")}}function R(e,t){if(1&e){var n=b.Zb();b.Yb(0,"nb-card"),b.Yb(1,"nb-card-header"),b.Ic(2,"Join Channel"),b.Xb(),b.Yb(3,"nb-card-body",15),b.Yb(4,"div",16),b.Ic(5," Import Folder Structure: "),b.Yb(6,"mat-form-field",26),b.Yb(7,"mat-select",27),b.fc("valueChange",(function(e){return b.xc(n),b.jc().importFolderStructure=e}))("selectionChange",(function(e){return b.xc(n),b.jc().newInviteImportFoldersChanged(e.value)})),b.Yb(8,"mat-option",23),b.Ic(9," On "),b.Xb(),b.Yb(10,"mat-option",23),b.Ic(11," Off "),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Yb(12,"div",16),b.Ic(13," Place Into Folder: "),b.Yb(14,"mat-select",17),b.fc("valueChange",(function(e){return b.xc(n),b.jc().newChannelFolder=e}))("selectionChange",(function(e){return b.xc(n),b.jc().newChannelFolderChanged(e.value)})),b.Gc(15,E,2,2,"mat-option",18),b.Xb(),b.Xb(),b.Yb(16,"div",19),b.Yb(17,"input",28),b.fc("ngModelChange",(function(e){return b.xc(n),b.jc().inviteCodeHex=e}))("keydown",(function(e){return b.xc(n),b.jc().importNewChannelKeyDown(e)})),b.Xb(),b.Yb(18,"nb-icon",29),b.fc("click",(function(){return b.xc(n),b.jc().scanQR()})),b.Xb(),b.Xb(),b.Xb(),b.Yb(19,"nb-card-footer"),b.Yb(20,"button",21),b.fc("click",(function(){b.xc(n);var e=b.jc();return e.importNewChannel(e.inviteCode)})),b.Ic(21,"Join"),b.Xb(),b.Yb(22,"button",22),b.fc("click",(function(){return b.xc(n),b.jc().closePopup()})),b.Ic(23,"Cancel"),b.Xb(),b.Xb(),b.Xb()}if(2&e){var i=b.jc();b.Fb(7),b.pc("value",i.importFolderStructure),b.Fb(1),b.pc("value",1),b.Fb(2),b.pc("value",0),b.Fb(4),b.pc("value",i.newChannelFolder),b.Fb(1),b.pc("ngForOf",i.channelFolderListArray),b.Fb(2),b.pc("ngModel",i.inviteCodeHex)}}function D(e,t){if(1&e&&(b.Yb(0,"mat-option",23),b.Ic(1),b.Xb()),2&e){var n=t.$implicit;b.pc("value",n.id),b.Fb(1),b.Kc(" ",n.data.name," ")}}function B(e,t){if(1&e){var n=b.Zb();b.Yb(0,"nb-card"),b.Yb(1,"nb-card-header"),b.Ic(2,"New Channel Folder"),b.Xb(),b.Yb(3,"nb-card-body",15),b.Yb(4,"div",16),b.Ic(5," Folder: "),b.Yb(6,"mat-select",17),b.fc("valueChange",(function(e){return b.xc(n),b.jc().newChannelFolder=e}))("selectionChange",(function(e){return b.xc(n),b.jc().newChannelFolderChanged(e.value)})),b.Gc(7,D,2,2,"mat-option",18),b.Xb(),b.Xb(),b.Yb(8,"div",19),b.Yb(9,"input",30),b.fc("ngModelChange",(function(e){return b.xc(n),b.jc().newFolderName=e}))("keydown",(function(e){b.xc(n);var t=b.jc();return t.createNewFolderKeyDown(t.newFolderName,e)})),b.Xb(),b.Xb(),b.Xb(),b.Yb(10,"nb-card-footer"),b.Yb(11,"button",21),b.fc("click",(function(){b.xc(n);var e=b.jc();return e.createNewFolder(e.newFolderName)})),b.Ic(12,"Create"),b.Xb(),b.Yb(13,"button",22),b.fc("click",(function(){return b.xc(n),b.jc().closePopup()})),b.Ic(14,"Cancel"),b.Xb(),b.Xb(),b.Xb()}if(2&e){var i=b.jc();b.Fb(6),b.pc("value",i.newChannelFolder),b.Fb(1),b.pc("ngForOf",i.channelFolderListArray),b.Fb(2),b.pc("ngModel",i.newFolderName)}}var L=function(e){return{"drag-start":e}};function _(e,t){if(1&e){var n=b.Zb();b.Yb(0,"mat-tree-node",31),b.fc("dragover",(function(e){b.xc(n);var i=t.$implicit;return b.jc().handleDragOver(e,i)}))("dragend",(function(e){return b.xc(n),b.jc().handleDragEnd(e)}))("drop",(function(e){b.xc(n);var i=t.$implicit;return b.jc().handleDrop(e,i)}))("click",(function(){b.xc(n);var e=t.$implicit;return b.jc().selectChannel(e.item)})),b.Yb(1,"div"),b.Tb(2,"nb-icon",32),b.Yb(3,"span",33),b.fc("dragstart",(function(e){b.xc(n);var i=t.$implicit;return b.jc().handleDragStart(e,i)})),b.Yb(4,"span",34),b.Ic(5),b.Xb(),b.Xb(),b.Xb(),b.Xb()}if(2&e){var i=t.$implicit,a=b.jc();b.pc("ngClass",a.getStyle(i)),b.Fb(1),b.Ib("treeNodeContainerSingle ",i.item,""),b.Kb("active-channel",a.selectedChannel===i.item),b.Fb(3),b.pc("ngClass",b.sc(8,L,a.dragNode===i)),b.Fb(1),b.Kc(" ",i.item," ")}}function A(e,t){if(1&e){var n=b.Zb();b.Yb(0,"mat-tree-node",35),b.fc("dragover",(function(e){b.xc(n);var i=t.$implicit;return b.jc().handleDragOver(e,i)}))("dragend",(function(e){b.xc(n);var i=t.$implicit;return b.jc().handleDragEnd(e,i)}))("drop",(function(e){b.xc(n);var i=t.$implicit;return b.jc().handleDrop(e,i)})),b.Yb(1,"div",36),b.fc("contextmenu",(function(e){b.xc(n);var i=t.$implicit;return b.jc().onContextMenu(e,i.item)})),b.Yb(2,"button",37),b.Yb(3,"mat-icon",38),b.Ic(4),b.Xb(),b.Xb(),b.Tb(5,"nb-icon",39),b.Yb(6,"span",33),b.fc("dragstart",(function(e){b.xc(n);var i=t.$implicit;return b.jc().handleDragStart(e,i)})),b.Yb(7,"span",34),b.Ic(8),b.Xb(),b.Xb(),b.Xb(),b.Xb()}if(2&e){var i=t.$implicit,a=b.jc();b.pc("ngClass",a.getStyle(i)),b.Fb(2),b.Gb("aria-label","toggle "+i.item),b.Fb(2),b.Kc(" ",a.treeControl.isExpanded(i)?"expand_more":"chevron_right"," "),b.Fb(3),b.pc("ngClass",b.sc(5,L,a.dragNode===i)),b.Fb(1),b.Kc(" ",a.getFolderNameFromId(i.item)," ")}}function K(e,t){if(1&e){var n=b.Zb();b.Yb(0,"button",40),b.fc("click",(function(){b.xc(n);var e=t.item;return b.jc().deleteFolder(e)})),b.Ic(1,"Delete"),b.Xb(),b.Yb(2,"button",40),b.fc("click",(function(){b.xc(n);var e=t.item;return b.jc().onContextMenuAction2(e)})),b.Ic(3,"Rename"),b.Xb(),b.Yb(4,"button",40),b.fc("click",(function(){b.xc(n);var e=t.item;return b.jc().onContextMenuAction2(e)})),b.Ic(5,"Export"),b.Xb()}}var G=function e(){r(this,e)},z=function e(){r(this,e)},H={},V=function(){var e=function(){function e(){r(this,e),this.dataChange=new l.a([]),this.initialize()}return o(e,[{key:"initialize",value:function(){this.buildFileTree(H,0)}},{key:"buildFileTree",value:function(e,t){var n=this;return Object.keys(e).reduce((function(i,a){var o=e[a],r=new G;return r.item=a,null!=o&&("object"==typeof o?r.children=n.buildFileTree(o,t+1):r.item=o),i.concat(r)}),[])}},{key:"insertItem",value:function(e,t){e.children||(e.children=[]);var n={item:t};return e.children.push(n),this.dataChange.next(this.data),n}},{key:"getParentFromNodes",value:function(e){for(var t=0;t<this.data.length;++t){var n=this.getParent(this.data[t],e);if(null!=n)return n}return null}},{key:"getParent",value:function(e,t){if(e.children&&e.children.length>0)for(var n=0;n<e.children.length;++n){var i=e.children[n];if(i===t)return e;if(i.children&&i.children.length>0){var a=this.getParent(i,t);if(null!=a)return a}}return null}},{key:"updateItem",value:function(e,t){e.item=t,this.dataChange.next(this.data)}},{key:"deleteItem",value:function(e){this.deleteNode(this.data,e),this.dataChange.next(this.data)}},{key:"copyPasteItem",value:function(e,t){var n=this,i=this.insertItem(t,e.item);return e.children&&e.children.forEach((function(e){n.copyPasteItem(e,i)})),i}},{key:"deleteNode",value:function(e,t){var n=this,i=e.indexOf(t,0);i>-1?e.splice(i,1):e.forEach((function(e){e.children&&e.children.length>0&&n.deleteNode(e.children,t)}))}},{key:"filter",value:function(e){var t;t=e&&e.length>0?{Filter:{emptyFolder:{}},Function:{emptyFolder:{}},Missing:{emptyFolder:{}}}:H;var n=this.buildFileTree(t,0);this.dataChange.next(n)}},{key:"setQOS",value:function(e){this.q=e}},{key:"data",get:function(){return this.dataChange.value}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=b.Ob({token:e,factory:e.\u0275fac}),e}(),Z=function(){var n=function(){function n(e,t,i,a,o,p){var b=this;r(this,n),this.cd=e,this.database=t,this.ui=i,this.dialog=a,this.nbMenuService=o,this.q=p,this.contextMenuPosition={x:"0px",y:"0px"},this.flatNodeMap=new Map,this.nestedNodeMap=new Map,this.selectedParent=null,this.newItemName="",this.checklistSelection=new d.c(!0),this.dragNodeExpandOverWaitTimeMs=300,this.getLevel=function(e){return e.level},this.isExpandable=function(e){return e.expandable},this.getChildren=function(e){return e.children},this.hasChild=function(e,t){return t.expandable},this.hasNoContent=function(e,t){return""===t.item},this.transformer=function(e,t){var n=b.nestedNodeMap.get(e),i=n&&n.item===e.item?n:new z;return i.item=e.item,i.level=t,i.expandable=e.children&&e.children.length>0,b.flatNodeMap.set(i,e),b.nestedNodeMap.set(e,i),i},this.dragNodeExpandOverAreaReal=0,this.channelNameList=[],this.restoreFlag=0,this.sENwriteBlock=0,this.channelIsSelected="active-channel",this.DEVMODE=s.dev,this.customColumn="name",this.items=[{title:"New Folder"},{title:"New Channel"},{title:"Join Channel"}],this.currentDevice=null,this.formatsEnabled=[c.BarcodeFormat.QR_CODE],this.torchEnabled=!1,this.torchAvailable$=new l.a(!1),this.tryHarder=!1,this.channelFolderListArray=[],this.popupRef=[],this.importFolderStructure=1,this.itemClickSub=this.nbMenuService.onItemClick().subscribe((function(e){"New Channel"==String(e.item.title)?(b.getChannelFolderList(),b.open(b.createPop)):"Join Channel"==String(e.item.title)?(b.getChannelFolderList(),b.open(b.importPop)):"New Folder"==String(e.item.title)&&(b.getChannelFolderList(),b.open(b.folderPop))})),this.database.setQOS(this.q),this.treeFlattener=new h.c(this.transformer,this.getLevel,this.isExpandable,this.getChildren),this.treeControl=new u.j(this.getLevel,this.isExpandable),this.dataSource=new h.b(this.treeControl,this.treeFlattener)}return o(n,[{key:"onContextMenu",value:function(e,t){e.preventDefault(),this.contextMenuPosition.x=e.clientX+"px",this.contextMenuPosition.y=e.clientY-40+"px",this.contextMenu.menuData={item:t},this.contextMenu.openMenu()}},{key:"onContextMenuAction1",value:function(e){}},{key:"onContextMenuAction2",value:function(e){}},{key:"descendantsAllSelected",value:function(e){var t=this;return this.treeControl.getDescendants(e).every((function(e){return t.checklistSelection.isSelected(e)}))}},{key:"descendantsPartiallySelected",value:function(e){var t=this;return this.treeControl.getDescendants(e).some((function(e){return t.checklistSelection.isSelected(e)}))&&!this.descendantsAllSelected(e)}},{key:"todoItemSelectionToggle",value:function(e){var n,i;this.checklistSelection.toggle(e);var a=this.treeControl.getDescendants(e);this.checklistSelection.isSelected(e)?(n=this.checklistSelection).select.apply(n,t(a)):(i=this.checklistSelection).deselect.apply(i,t(a))}},{key:"saveNode",value:function(e,t){var n=this.flatNodeMap.get(e);this.database.updateItem(n,t)}},{key:"handleDragStart",value:function(e,t){this.dragNode=t,this.treeControl.collapse(t)}},{key:"handleDragOver",value:function(e,t){if(e.preventDefault(),-1===t.item.indexOf("-----")){this.dragNodeExpandOverNode&&t===this.dragNodeExpandOverNode?Date.now()-this.dragNodeExpandOverTime>this.dragNodeExpandOverWaitTimeMs&&(this.treeControl.isExpanded(t)||this.treeControl.expand(t)):(this.dragNodeExpandOverNode=t,this.dragNodeExpandOverTime=(new Date).getTime());var n=e.offsetY/e.target.clientHeight;0<=n&&n<=.25?(this.dragNodeExpandOverArea=0,this.dragNodeExpandOverAreaReal=1):1>=n&&n>=.75?(this.dragNodeExpandOverArea=0,this.dragNodeExpandOverAreaReal=-1):(this.dragNodeExpandOverAreaReal=0,this.dragNodeExpandOverArea=0)}}},{key:"handleDrop",value:function(e,t){var n;t!==this.dragNode&&t.item.indexOf("-----")<0&&(1===this.dragNodeExpandOverAreaReal||-1===this.dragNodeExpandOverAreaReal||(n=this.flatNodeMap.get(this.dragNode),this.database.deleteItem(n),n=this.database.copyPasteItem(n,this.flatNodeMap.get(t)),this.saveExpandedNodes(),this.buildChannelFolderListFromTreeNodeData()));this.handleDragEnd(e)}},{key:"handleDragEnd",value:function(e){this.dragNode=null,this.dragNodeExpandOverNode=null,this.dragNodeExpandOverTime=0,this.dragNodeExpandOverArea=NaN,e.preventDefault()}},{key:"getStyle",value:function(e){if("emptyFolder"==e.item)return"display-none";if(this.dragNode===e)return"drag-start";if(this.dragNodeExpandOverNode===e)switch(this.dragNodeExpandOverArea){case 1:return"drop-above";case-1:return"drop-below";default:return"drop-center"}}},{key:"closeQR",value:function(){var e=this;setTimeout((function(){e.closePopup()}),500)}},{key:"scanQR",value:function(){this.open(this.qrPop)}},{key:"deleteItem",value:function(e){this.database.deleteItem(this.flatNodeMap.get(e))}},{key:"filterChanged",value:function(e){this.database.filter(e),e?this.treeControl.expandAll():this.treeControl.collapseAll()}},{key:"getFolderNameFromId",value:function(e){return"emptyFolder"==e?e:this.q.os.bee.config.getFolderNameFromId(e)}},{key:"isFolder",value:function(e){return!(e.indexOf("-----")>-1)}},{key:"ngOnDestroy",value:function(){console.log("ChannelList: ngOnDestroy..."),this.itemClickSub.unsubscribe(),this.dataChangeSub.unsubscribe(),this.channelFolderListSub.unsubscribe(),this.selectedChannelSub.unsubscribe()}},{key:"createNewChannelKeyDown",value:function(e,t){13===t.keyCode&&this.createNewChannel(e)}},{key:"importNewChannelKeyDown",value:function(e){13===e.keyCode&&this.importNewChannel()}},{key:"createNewFolderKeyDown",value:function(e,t){13===t.keyCode&&this.createNewFolder(e)}},{key:"ngOnInit",value:function(){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.q.os.isSignedIn()){e.next=6;break}return console.log("ChannelList: Waiting for OS Sign In..."),e.next=4,this.ui.delay(1e3);case 4:e.next=0;break;case 6:this.channelNameList=this.q.os.ocean.dolphin.getChannelNameList(),this.channelFolderList=this.q.os.bee.config.getChannelFolderList(),this.dataChangeSub=this.database.dataChange.subscribe((function(e){t.dataSource.data=[],t.dataSource.data=e})),this.channelFolderListSub=this.q.os.bee.config.channelFolderListSub.subscribe((function(e){t.loadChannels(e)})),this.selectedChannelSub=this.q.os.channel.onSelect().subscribe((function(e){t.selectedChannel=e})),this.loadChannels(this.channelFolderList),this.selectedChannel=this.q.os.channel.getSelected(),this.cd.detectChanges();case 7:case"end":return e.stop()}}),e,this)})))}},{key:"loadChannels",value:function(e){H=this.q.os.bee.config.getChannelFolderIDList(),this.database.filter(""),e.length>0&&this.q.os.bee.config.getExpandedChannelFolderItems().length>0&&(console.log("got a saved state!"),this.expandedNodes=this.q.os.bee.config.getExpandedChannelFolderItems(),this.restoreExpandedNodes())}},{key:"saveExpandedNodes",value:function(){this.sENwriteBlock=1,this.expandedNodes=[];for(var e=0;e<this.treeControl.dataNodes.length;e++){var t=this.treeControl.dataNodes[e];t.expandable&&this.treeControl.isExpanded(t)&&this.expandedNodes.push(t)}return console.log("ChannelList: Persisting expanded folders..."),this.q.os.bee.config.setExpandedChannelFolderItems(this.expandedNodes),this.sENwriteBlock=0,!0}},{key:"buildChannelFolderListFromTreeNodeData",value:function(){console.log("!!!!!"),console.log(this.database.data);var e=this.database.data;e=e.filter((function(e){return"emptyFolder"!=e.item}));for(var t=[],n=0;n<e.length;n++){console.log(e[n]);var i="dir";e[n].item.indexOf("-----")>-1&&(i="channel"),console.log(i);var a=[];void 0!==e[n].children&&e[n].children.length>0&&(a=this.getFolderListTreeChildrenRec(e[n].children)),t.push({id:e[n].item,data:{name:this.q.os.bee.config.getFolderNameFromId(e[n].item),kind:i,items:0},children:a})}return this.q.os.bee.config.setChannelFolderList(t),!0}},{key:"selectChannel",value:function(e){var t=this;console.log("ChannelList: Trying to select: >>"+e.trim()),this.q.os.utilities.inArray(this.q.os.ocean.dolphin.getChannelNameList(),e.trim())&&(console.log("ChannelList: Selecting: ",e.trim()),this.q.os.channel.select(e.trim()),this.q.os.ui.getSideBarFixed().left&&this.q.os.ui.hideSideBar("left"),this.cd.detectChanges(),setTimeout((function(){t.scrollBottom()}),2500),setTimeout((function(){t.scrollBottom()}),5500),setTimeout((function(){t.scrollBottom()}),4e3))}},{key:"getSelected",value:function(){return JSON.stringify(this.selectedChannel)}},{key:"scrollBottom",value:function(){try{this.scrollable={},this.scrollable.nativeElement=window["quest-network-ui-globals"]["messages-chat-scrollable"],null!=this.scrollable.nativeElement&&this.scrollable.nativeElement.scrollTop>this.scrollable.nativeElement.scrollHeight-$(this.scrollable.nativeElement).height()-210&&(this.scrollable.nativeElement.scrollTop=this.scrollable.nativeElement.scrollHeight)}catch(e){console.log(e)}}},{key:"getFolderListTreeChildrenRec",value:function(e){for(var t=[],n=0;n<e.length;n++){console.log(e[n]);var i="dir";e[n].item.indexOf("-----")>-1&&(i="channel");var a=[];void 0!==e[n].children&&e[n].children.length>0&&(a=this.getFolderListTreeChildrenRec(e[n].children)),t.push({id:e[n].item,data:{name:this.q.os.bee.config.getFolderNameFromId(e[n].item),kind:i,items:0},children:a})}return t}},{key:"restoreExpandedNodes",value:function(){var e=this;this.sENwriteBlock=1;for(var t=function(t){var n=e.expandedNodes[t];console.log(n),console.log(e.treeControl.dataNodes),e.treeControl.expand(e.treeControl.dataNodes.find((function(e){return e.item===n.item})))},n=0;n<this.expandedNodes.length;n++)t(n);this.sENwriteBlock=0}},{key:"onCamerasFound",value:function(e){this.availableDevices=e,this.hasDevices=Boolean(e&&e.length)}},{key:"onDeviceSelectChange",value:function(e){var t=this.availableDevices.find((function(t){return t.deviceId===e}));this.currentDevice=t||null}},{key:"onHasPermission",value:function(e){this.hasPermission=e}},{key:"onTorchCompatible",value:function(e){this.torchAvailable$.next(e||!1)}},{key:"toggleTorch",value:function(){this.torchEnabled=!this.torchEnabled}},{key:"toggleTryHarder",value:function(){this.tryHarder=!this.tryHarder}},{key:"qrSuccessHandler",value:function(e){console.log(e),this.inviteCodeHex=e,this.closePopup()}},{key:"getChannelFolderList",value:function(){return this.channelFolderList=this.q.os.bee.config.getChannelFolderList(),this.channelFolderListArray=[],this.parseStructure(this.channelFolderList),this.channelFolderListArray.length>0&&(this.newChannelFolder=this.channelFolderListArray[0]),this.channelFolderList}},{key:"parseStructure",value:function(e){for(var t=0;t<e.length;t++)-1===e[t].data.name.indexOf("-----")&&"emptyFolder"!=e[t].data.name&&(this.channelFolderListArray.push(e[t]),void 0!==e[t].children&&this.parseStructure(e[t].children));return e}},{key:"newChannelFolderChanged",value:function(){}},{key:"createNewChannel",value:function(e){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.saveExpandedNodes(),console.log(e),n=e,this.ui.showSnack("Creating Channel...","Please Wait"),"object"==typeof(i=this.newChannelFolder)&&(i=""),t.next=7,this.q.os.channel.create(n,i);case 7:this.createCompleteAndClose();case 8:case"end":return t.stop()}}),t,this)})))}},{key:"open",value:function(e){this.popupRef.push(this.dialog.open(e,{context:"this is some additional data passed to dialog"}))}},{key:"closePopup",value:function(){console.log("close toggled"),this.popupRef[this.popupRef.length-1].close(),this.popupRef.pop()}},{key:"createCompleteAndClose",value:function(){this.ui.delay(1e3),this.q.os.bee.config.commit(),this.ui.showSnack("Success!","Yesss",{duration:1e3}),this.closePopup()}},{key:"createNewFolder",value:function(e){this.saveExpandedNodes(),this.ui.showSnack("Creating Folder...","Please Wait");var t=this.newChannelFolder;"object"==typeof t&&(t=""),this.q.os.bee.config.createChannelFolder(e,t),this.createCompleteAndClose()}},{key:"deleteFolder",value:function(e){console.log("Deleting Folder..."),console.log(e);var t=this.q.os.bee.config.checkIfFolderIdChannels(e);console.log(t),t?this.ui.showSnack("Folder has channels!","Sorry but no.",{duration:5e3}):(this.ui.showSnack("Deleting Folder...","Please Wait"),this.saveExpandedNodes(),this.q.os.bee.config.deleteFolder(e),this.createCompleteAndClose())}},{key:"importChannelFolderChanged",value:function(){}},{key:"importNewChannel",value:function(){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i,a,o,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.saveExpandedNodes(),this.ui.showSnack("Importing Channel...","Please Wait"),a=e.from(this.inviteCodeHex,"hex").toString("utf8"),(o=a.split("/////")).length>0?(n=o[o.length-1].split(":")[0],i=o[o.length-1].split(":")[1],o.pop()):(n=a.split(":")[0],i=a.split(":")[1]),"object"!=typeof(r=this.newChannelFolder)&&void 0!==r&&null!=typeof r||(r=""),!this.q.os.utilities.inArray(this.q.os.ocean.dolphin.getChannelNameList(),n)){t.next=9;break}this.ui.showSnack("Channel Exists!","Oops",{duration:1e3}),t.next=12;break;case 9:return t.next=11,this.q.os.channel.import(n,o,r,i,this.importFolderStructure);case 11:this.createCompleteAndClose();case 12:case"end":return t.stop()}}),t,this)})))}},{key:"newInviteImportFoldersChanged",value:function(){}}]),n}();return n.\u0275fac=function(e){return new(e||n)(b.Sb(b.h),b.Sb(V),b.Sb(g.a),b.Sb(f.l),b.Sb(f.y),b.Sb(v.a))},n.\u0275cmp=b.Mb({type:n,selectors:[["messages-channel-list"]],viewQuery:function(e,t){var n;1&e&&(b.Mc(p.d,!0),b.Mc(N,!0),b.Mc(P,!0),b.Mc(M,!0),b.Mc(X,!0),b.Mc(j,!0)),2&e&&(b.uc(n=b.gc())&&(t.contextMenu=n.first),b.uc(n=b.gc())&&(t.emptyItem=n.first),b.uc(n=b.gc())&&(t.qrPop=n.first),b.uc(n=b.gc())&&(t.createPop=n.first),b.uc(n=b.gc())&&(t.folderPop=n.first),b.uc(n=b.gc())&&(t.importPop=n.first))},features:[b.Eb([V])],decls:21,vars:9,consts:[["createPop",""],["qrPop",""],["import",""],["folder",""],[2,"width","169px","margin-top","20px","color","#598adb"],["matInput","","placeholder","Search",3,"input"],["outline","","size","small",1,"addChannelButton",3,"nbContextMenu"],["icon","plus-outline",2,"font-size","18px","width","auto"],[3,"dataSource","treeControl"],["matTreeNodeToggle","","matTreeNodePadding","",3,"ngClass","dragover","dragend","drop","click",4,"matTreeNodeDef"],["matTreeNodePadding","",3,"ngClass","dragover","dragend","drop",4,"matTreeNodeDef","matTreeNodeDefWhen"],[2,"visibility","hidden","position","fixed",3,"matMenuTriggerFor"],["contextMenu","matMenu"],["matMenuContent",""],["emptyItem",""],[2,"color","goldenrod"],[2,"padding","20px"],[2,"width","80%","margin-left","10px",3,"value","valueChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[2,"padding","20px","padding-bottom","34px","padding-top","0px","color","white !important"],["matInput","","placeholder","Channel Name","value","","name","newChannelName",2,"color","black","background-color","goldenrod","padding","7px",3,"ngModel","ngModelChange","keydown"],["mat-stroked-button","","color","primary",2,"margin-right","20px","border","1px solid #ffffff24",3,"click"],["mat-stroked-button","","color","primary",2,"border","1px solid #ffffff24",3,"click"],[3,"value"],[1,"qrScanWrapper"],[3,"torch","device","formats","tryHarder","deviceChange","scanSuccess","permissionResponse","camerasFound","torchCompatible"],[2,"width","19%"],[3,"value","valueChange","selectionChange"],["matInput","","placeholder","Invite Code","value","","name","inviteCodeHex",2,"color","black","background-color","goldenrod","padding","7px","margin-right","5%","width","80%",3,"ngModel","ngModelChange","keydown"],["icon","camera-outline",1,"deleteCode","scanQRCode",3,"click"],["matInput","","placeholder","Folder Name","value","","name","newFolderName",2,"color","black","background-color","goldenrod","padding","7px",3,"ngModel","ngModelChange","keydown"],["matTreeNodeToggle","","matTreeNodePadding","",3,"ngClass","dragover","dragend","drop","click"],["icon","activity"],["draggable","true",1,"checklist-leaf-node",3,"dragstart"],[1,"nodeContent",3,"ngClass"],["matTreeNodePadding","",3,"ngClass","dragover","dragend","drop"],[1,"treeNodeContainerFolder",3,"contextmenu"],["mat-icon-button","","matTreeNodeToggle",""],[1,"mat-icon-rtl-mirror"],["icon","folder-outline"],["mat-menu-item","",3,"click"]],template:function(e,t){if(1&e&&(b.Gc(0,q,15,3,"ng-template",null,0,b.Hc),b.Gc(2,T,9,4,"ng-template",null,1,b.Hc),b.Gc(4,R,24,6,"ng-template",null,2,b.Hc),b.Gc(6,B,15,3,"ng-template",null,3,b.Hc),b.Yb(8,"mat-form-field",4),b.Yb(9,"input",5),b.fc("input",(function(e){return t.filterChanged(e.target.value)})),b.Xb(),b.Xb(),b.Yb(10,"button",6),b.Tb(11,"nb-icon",7),b.Xb(),b.Yb(12,"mat-tree",8),b.Gc(13,_,6,10,"mat-tree-node",9),b.Gc(14,A,9,7,"mat-tree-node",10),b.Xb(),b.Tb(15,"div",11),b.Yb(16,"mat-menu",null,12),b.Gc(18,K,6,0,"ng-template",13),b.Xb(),b.Tb(19,"span",null,14)),2&e){var n=b.vc(17);b.Fb(10),b.pc("nbContextMenu",t.items),b.Fb(2),b.pc("dataSource",t.dataSource)("treeControl",t.treeControl),b.Fb(2),b.pc("matTreeNodeDefWhen",t.hasChild),b.Fb(1),b.Dc("left",t.contextMenuPosition.x)("top",t.contextMenuPosition.y),b.pc("matMenuTriggerFor",n)}},directives:[m.b,C.a,f.i,f.o,h.a,h.f,p.d,p.e,p.a,f.d,f.f,f.c,x.a,y.l,k.b,k.j,k.m,f.e,F.a,w.g,S.a,h.e,h.h,h.g,y.k,I.a,O.a,p.b],styles:["button[nbTreeGridRowToggle][_ngcontent-%COMP%]{background:transparent;border:none;padding:0}.search-label[_ngcontent-%COMP%]{display:block}.search-input[_ngcontent-%COMP%]{background:transparent;color:#fff;padding:5px;font-size:12px;width:100%;margin-top:1rem;margin-bottom:1rem;width:78%;margin-left:1%}.addChannelButton[_ngcontent-%COMP%]{color:rgba(134,116,183,.7490196078431373);margin-left:5%;position:relative;top:1px;background-color:#45267d;border:1px solid;border-radius:5px;padding:4px;opacity:.7}.nb-column-name[_ngcontent-%COMP%]{width:80%}.nb-column-items[_ngcontent-%COMP%]{width:20%}.scanQRCode[_ngcontent-%COMP%]{font-size:37px;color:#315cdf;cursor:pointer}.scanQRCode[_ngcontent-%COMP%]:hover{color:#4a81e6}[_nghost-%COMP%]   nb-layout-header[_ngcontent-%COMP%]     nav{justify-content:flex-end}.mat-tree[_ngcontent-%COMP%], .mat-tree-node[_ngcontent-%COMP%]{background:transparent}.mat-tree-node[_ngcontent-%COMP%]{overflow:visible;cursor:move}.drop-above[_ngcontent-%COMP%]{border-top:10px solid #2196f3;margin-top:-10px}.drop-below[_ngcontent-%COMP%]{border-bottom:10px solid #2196f3;margin-bottom:-10px}.drop-center[_ngcontent-%COMP%]{background-color:#a9a9a9}.drag-start[_ngcontent-%COMP%]{background-color:#1565c0;color:#f0fff0}.treeNodeContainerFolder[_ngcontent-%COMP%]{background-color:rgba(131,119,230,.058823529411764705);padding:0 16px 0 0}.treeNodeContainerFolder[_ngcontent-%COMP%], .treeNodeContainerSingle[_ngcontent-%COMP%]{border-radius:5px;margin:0;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.treeNodeContainerSingle[_ngcontent-%COMP%]{background-color:rgba(69,39,128,.3686274509803922);padding:6px 10px 6px 15px}.mat-tree[_ngcontent-%COMP%]{z-index:999;width:227px;left:14px;top:190px;padding-right:10px;bottom:40px;position:fixed;overflow:scroll}.mat-tree[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px}.mat-tree[_ngcontent-%COMP%]::-webkit-scrollbar-track{box-shadow:inset 0 0 6px rgba(0,0,0,.3)}.mat-tree[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:rgba(78,132,229,.5607843137254902);outline:0}.mat-tree[_ngcontent-%COMP%]::-webkit-scrollbar-track{box-shadow:none!important}.emptyFolder[_ngcontent-%COMP%]{display:none}.mat-icon-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], .mat-icon-button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{line-height:20px}.qrScanWrapper[_ngcontent-%COMP%]{min-width:20px;max-height:80vh;max-width:37vw}"]}),n}()}).call(this,i("tjlA").Buffer)},tayM:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function e(){r(this,e)}},waa1:function(t,n,i){"use strict";i.d(n,"a",(function(){return w}));var a=i("fXoL"),c=i("tyNb"),s=i("gvxT"),l=i("ofXK"),d=i("aceb"),u=i("zwFz"),h=i("fP41");function p(e,t){1&e&&a.Tb(0,"nb-icon",7)}function b(e,t){1&e&&a.Tb(0,"nb-icon",8)}function g(e,t){if(1&e){var n=a.Zb();a.Yb(0,"p",4),a.fc("click",(function(){a.xc(n);var e=a.jc();return e.goToProfile(e.sender.social)})),a.Ic(1),a.Gc(2,p,1,0,"nb-icon",5),a.Gc(3,b,1,0,"nb-icon",6),a.Xb()}if(2&e){var i=a.jc();a.Fb(1),a.Kc(" ",i.sender.name," "),a.Fb(1),a.pc("ngIf",i.sender.isRequestedFavorite),a.Fb(1),a.pc("ngIf",i.sender.isFavorite)}}function f(e,t){if(1&e&&(a.Yb(0,"p",9),a.Ic(1),a.Xb()),2&e){var n=a.jc();a.Fb(1),a.Kc(" ",n.sender.name," ")}}var v=function(){return{newWindow:!0}};function m(e,t){if(1&e&&(a.Tb(0,"div",17),a.kc(1,"linky")),2&e){var n=a.jc().$implicit;a.pc("innerHTML",a.mc(1,1,n.text,a.rc(4,v)),a.yc)}}function C(e,t){if(1&e&&a.Tb(0,"ngx-emoji",18),2&e){var n=a.jc().$implicit;a.pc("emoji",n.emojiColon)}}function x(e,t){if(1&e&&(a.Yb(0,"div",14),a.Gc(1,m,2,5,"div",15),a.Gc(2,C,1,1,"ngx-emoji",16),a.Xb()),2&e){var n=t.$implicit;a.Fb(1),a.pc("ngIf",!n.isEmoji),a.Fb(1),a.pc("ngIf",n.isEmoji)}}function y(e,t){if(1&e&&(a.Yb(0,"div",12),a.Gc(1,x,3,2,"div",13),a.Xb()),2&e){var n=t.$implicit;a.Fb(1),a.pc("ngForOf",n)}}function k(e,t){if(1&e&&(a.Yb(0,"div",10),a.Gc(1,y,2,1,"div",11),a.Xb()),2&e){var n=a.jc();a.Fb(1),a.pc("ngForOf",n.messageRows)}}function F(e,t){if(1&e&&(a.Yb(0,"div"),a.Tb(1,"ngx-emoji",19),a.Xb()),2&e){var n=a.jc();a.Fb(1),a.qc("emoji",n.messageRows[0][0].emojiColon)}}var w=function(){var t=function(){function t(e,n,i){r(this,t),this.ngZone=e,this.router=n,this.q=i,this.scrollable={}}return o(t,[{key:"scrollBottom",value:function(){try{this.scrollable.nativeElement=window["quest-network-ui-globals"]["messages-chat-scrollable"],null!=this.scrollable.nativeElement&&this.scrollable.nativeElement.scrollTop>this.scrollable.nativeElement.scrollHeight-$(this.scrollable.nativeElement).height()-210&&(this.scrollable.nativeElement.scrollTop=this.scrollable.nativeElement.scrollHeight)}catch(e){console.log(e)}}},{key:"ngOnInit",value:function(){this.messageRows=this.getArray(this.message),this.scrollBottom()}},{key:"ngOnChanges",value:function(){this.messageRows=this.getArray(this.message),this.scrollBottom()}},{key:"goToProfile",value:function(e){var t=this;this.ngZone.run((function(){return t.router.navigate(["/social/profile/"+e])}))}},{key:"getArray",value:function(t){var n=[],i=[],a=String(t).trim();try{for(var o=0,r=["\n:","\n :","\n  :"];o<r.length;o++){var c=r[o];a=a.replace(new RegExp(c,"g")," :")}}catch(y){}try{for(var s=0,l=[":D",":\\)","=\\)",":-\\)","=D"];s<l.length;s++){var d=l[s];a=a.replace(new RegExp(d,"g"),":grinning:")}var u,h=e(/:(?![\n])[()#$@-\w]+:/g.exec(a));try{for(h.s();!(u=h.n()).done;){var p=u.value;p.substr(1,p.length-2).indexOf(":")<0&&(a=a.replace(p," "+p+" "))}}catch(k){h.e(k)}finally{h.f()}}catch(y){console.log(y)}i=[];var b,g=e(a.trim().split("\n"));try{for(g.s();!(b=g.n()).done;){var f=b.value;i.push(f.trim().split(" "))}}catch(k){g.e(k)}finally{g.f()}for(var v=0;v<i.length;v++)for(var m=0;m<i[v].length;m++){var C=String(i[v][m]).trim();if(0==C.indexOf(":")&&C.substr(1).indexOf(":")==C.length-2){var x={isEmoji:!0,emojiColon:C.substr(1,C.length-2)};if(1==n.length)return x;i[v][m]=x}else i[v][m]={isEmoji:!1,text:C}}return i}}]),t}();return t.\u0275fac=function(e){return new(e||t)(a.Sb(a.C),a.Sb(c.c),a.Sb(s.a))},t.\u0275cmp=a.Mb({type:t,selectors:[["nb-chat-message-text"]],inputs:{sender:"sender",message:"message",date:"date"},features:[a.Db],decls:4,vars:4,consts:[["class","sender","class","socialLink messageDisplayName",3,"click",4,"ngIf"],["class","sender","class","messageDisplayName",4,"ngIf"],["class","text",4,"ngIf"],[4,"ngIf"],[1,"socialLink","messageDisplayName",3,"click"],["icon","star-outline","class","senderIcon messageSenderStarIcon",4,"ngIf"],["icon","heart-outline","class","senderIcon",4,"ngIf"],["icon","star-outline",1,"senderIcon","messageSenderStarIcon"],["icon","heart-outline",1,"senderIcon"],[1,"messageDisplayName"],[1,"text"],["style","display:block;clear:both;",4,"ngFor","ngForOf"],[2,"display","block","clear","both"],["class","chunkContainer",4,"ngFor","ngForOf"],[1,"chunkContainer"],["class","textChunk",3,"innerHTML",4,"ngIf"],["class","emojiChunk","set","apple","size","22","style","display:inline-block;max-height: 22px;overflow: hidden;",3,"emoji",4,"ngIf"],[1,"textChunk",3,"innerHTML"],["set","apple","size","22",1,"emojiChunk",2,"display","inline-block","max-height","22px","overflow","hidden",3,"emoji"],["set","apple","size","64",1,"",3,"emoji"]],template:function(e,t){1&e&&(a.Gc(0,g,4,3,"p",0),a.Gc(1,f,2,1,"p",1),a.Gc(2,k,2,1,"div",2),a.Gc(3,F,2,1,"div",3)),2&e&&(a.pc("ngIf","unknown"!==t.sender.social),a.Fb(1),a.pc("ngIf","unknown"==t.sender.social),a.Fb(1),a.pc("ngIf",t.messageRows.length>0&&(t.messageRows.length>1||!t.messageRows[0][0].isEmoji)),a.Fb(1),a.pc("ngIf",1==t.messageRows.length&&1==t.messageRows[0].length&&t.messageRows[0][0].isEmoji))},directives:[l.m,d.o,l.l,u.a],pipes:[h.b],styles:[".senderIcon[_ngcontent-%COMP%]{top:-2px;position:relative;color:#d2d24b}.socialLink[_ngcontent-%COMP%]{cursor:pointer}.messageDisplayName[_ngcontent-%COMP%]{color:#d6d8dc!important;padding-bottom:5px!important}.messageSenderStarIcon[_ngcontent-%COMP%]{color:#256dff!important}.emojiChunk[_ngcontent-%COMP%]{max-height:22px;overflow:hidden;margin:0;position:relative;top:5px;padding:0 2px}.chunkContainer[_ngcontent-%COMP%], .emojiChunk[_ngcontent-%COMP%], .messagesInnerWrapper[_ngcontent-%COMP%], .textChunk[_ngcontent-%COMP%]{display:inline-block}.textChunk[_ngcontent-%COMP%]{white-space:nowrap;padding-left:2px;padding-right:2px;max-height:22px}"],changeDetection:0}),t}()},xUDc:function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var i=n("R0Ic"),a=n("fXoL"),c=n("jhN1"),s=n("ofXK"),l=n("bzWg"),d=n("cVQz"),u=n("K9Od"),h=n("waa1");function p(e,t){if(1&e&&(a.Wb(0),a.Ic(1),a.Vb()),2&e){var n=a.jc(2);a.Fb(1),a.Kc(" ",n.getInitials()," ")}}function b(e,t){if(1&e&&(a.Yb(0,"div",7),a.Gc(1,p,2,1,"ng-container",8),a.Xb()),2&e){var n=a.jc();a.Dc("background-image",n.avatarStyle),a.Fb(1),a.pc("ngIf",!n.avatarStyle)}}function g(e,t){if(1&e&&a.Tb(0,"nb-chat-message-file",9),2&e){var n=a.jc();a.pc("sender",n.sender)("date",n.date)("message",n.message)("files",n.files)}}function f(e,t){if(1&e&&a.Tb(0,"nb-chat-message-quote",10),2&e){var n=a.jc();a.pc("sender",n.sender)("date",n.date)("message",n.message)("quote",n.quote)}}function v(e,t){if(1&e&&a.Tb(0,"nb-chat-message-map",11),2&e){var n=a.jc();a.pc("sender",n.sender)("date",n.date)("message",n.message)("latitude",n.latitude)("longitude",n.longitude)}}function m(e,t){if(1&e&&a.Tb(0,"nb-chat-message-text",12),2&e){var n=a.jc();a.pc("sender",n.sender)("date",n.date)("message",n.message)}}var C=function(){var e=function(){function e(t){r(this,e),this.domSanitizer=t,this._reply=!1}return o(e,[{key:"getInitials",value:function(){return this.sender?this.sender.split(" ").map((function(e){return e.charAt(0)})).splice(0,2).join("").toUpperCase():""}},{key:"flyInOut",get:function(){return!0}},{key:"notReply",get:function(){return!this.reply}},{key:"reply",get:function(){return this._reply},set:function(e){var t;this._reply="string"==typeof(t=e)?"true"===(t=t.toLowerCase().trim())||""===t:!!t}},{key:"avatar",set:function(e){this.avatarStyle=e?this.domSanitizer.bypassSecurityTrustStyle("url(".concat(e,")")):null}}]),e}();return e.\u0275fac=function(t){return new(t||e)(a.Sb(c.b))},e.\u0275cmp=a.Mb({type:e,selectors:[["nb-chat-message"]],hostVars:5,hostBindings:function(e,t){2&e&&(a.Fc("@flyInOut",t.flyInOut),a.Kb("not-reply",t.notReply)("reply",t.reply))},inputs:{reply:"reply",message:"message",sender:"sender",date:"date",files:"files",quote:"quote",latitude:"latitude",longitude:"longitude",avatar:"avatar",type:"type"},decls:7,vars:5,consts:[["class","avatar",3,"background-image",4,"ngIf"],[1,"message"],[3,"ngSwitch"],[3,"sender","date","message","files",4,"ngSwitchCase"],[3,"sender","date","message","quote",4,"ngSwitchCase"],[3,"sender","date","message","latitude","longitude",4,"ngSwitchCase"],[3,"sender","date","message",4,"ngSwitchDefault"],[1,"avatar"],[4,"ngIf"],[3,"sender","date","message","files"],[3,"sender","date","message","quote"],[3,"sender","date","message","latitude","longitude"],[3,"sender","date","message"]],template:function(e,t){1&e&&(a.Gc(0,b,2,3,"div",0),a.Yb(1,"div",1),a.Wb(2,2),a.Gc(3,g,1,4,"nb-chat-message-file",3),a.Gc(4,f,1,4,"nb-chat-message-quote",4),a.Gc(5,v,1,5,"nb-chat-message-map",5),a.Gc(6,m,1,3,"nb-chat-message-text",6),a.Vb(),a.Xb()),2&e&&(a.pc("ngIf",!t.reply),a.Fb(2),a.pc("ngSwitch",t.type),a.Fb(1),a.pc("ngSwitchCase","file"),a.Fb(1),a.pc("ngSwitchCase","quote"),a.Fb(1),a.pc("ngSwitchCase","map"))},directives:[s.m,s.o,s.p,s.q,l.a,d.a,u.a,h.a],encapsulation:2,data:{animation:[Object(i.m)("flyInOut",[Object(i.j)("in",Object(i.k)({transform:"translateX(0)"})),Object(i.l)("void => *",[Object(i.k)({transform:"translateX(-100%)"}),Object(i.e)(80)]),Object(i.l)("* => void",[Object(i.e)(80,Object(i.k)({transform:"translateX(100%)"}))])])]},changeDetection:0}),e}()}}])}();